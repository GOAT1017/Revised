<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Griffin's Rise: Advanced Trading Journal ‚Äî Pro Edition</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Tailwind for utility classes -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- FontAwesome for icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
  <!-- External Custom Styles -->
  <link rel="stylesheet" href="styles.css">
  <!-- Minimal inline styles for compatibility -->
  <style>
    html, body {
      background: #232946;
      color: #dbeafe;
      font-family: 'Montserrat', system-ui, sans-serif;
      min-height: 100vh;
      font-size: 16px;
      margin: 0;
      padding: 0;
    }
    
    /* Core Tailwind-like utilities */
    .hidden { display: none !important; }
    .flex { display: flex; }
    .flex-col { flex-direction: column; }
    .flex-row { flex-direction: row; }
    .items-center { align-items: center; }
    .justify-center { justify-content: center; }
    .justify-between { justify-content: space-between; }
    .gap-1 { gap: 0.25rem; }
    .gap-2 { gap: 0.5rem; }
    .gap-3 { gap: 0.75rem; }
    .gap-4 { gap: 1rem; }
    .gap-6 { gap: 1.5rem; }
    .gap-8 { gap: 2rem; }
    .p-3 { padding: 0.75rem; }
    .p-4 { padding: 1rem; }
    .p-5 { padding: 1.25rem; }
    .p-6 { padding: 1.5rem; }
    .p-8 { padding: 2rem; }
    .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
    .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
    .px-4 { padding-left: 1rem; padding-right: 1rem; }
    .px-5 { padding-left: 1.25rem; padding-right: 1.25rem; }
    .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
    .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
    .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
    .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
    .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
    .mb-1 { margin-bottom: 0.25rem; }
    .mb-2 { margin-bottom: 0.5rem; }
    .mb-3 { margin-bottom: 0.75rem; }
    .mb-4 { margin-bottom: 1rem; }
    .mb-5 { margin-bottom: 1.25rem; }
    .mb-6 { margin-bottom: 1.5rem; }
    .mb-8 { margin-bottom: 2rem; }
    .mt-2 { margin-top: 0.5rem; }
    .mt-3 { margin-top: 0.75rem; }
    .mt-4 { margin-top: 1rem; }
    .mt-5 { margin-top: 1.25rem; }
    .mt-6 { margin-top: 1.5rem; }
    .ml-2 { margin-left: 0.5rem; }
    .ml-3 { margin-left: 0.75rem; }
    .ml-auto { margin-left: auto; }
    .mr-2 { margin-right: 0.5rem; }
    .mr-3 { margin-right: 0.75rem; }
    .w-full { width: 100%; }
    .max-w-4xl { max-width: 56rem; }
    .max-w-6xl { max-width: 72rem; }
    .mx-auto { margin-left: auto; margin-right: auto; }
    .rounded { border-radius: 0.375rem; }
    .rounded-lg { border-radius: 0.5rem; }
    .rounded-xl { border-radius: 0.75rem; }
    .rounded-full { border-radius: 9999px; }
    .shadow { box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); }
    .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
    .shadow-xl { box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }
    .border { border-width: 1px; }
    .border-2 { border-width: 2px; }
    .border-blue-900 { border-color: #1e3a8a; }
    .border-blue-700 { border-color: #1d4ed8; }
    .border-green-400 { border-color: #4ade80; }
    .border-yellow-400 { border-color: #facc15; }
    .border-l-4 { border-left-width: 4px; }
    .text-center { text-align: center; }
    .text-left { text-align: left; }
    .text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
    .text-2xl { font-size: 1.5rem; line-height: 2rem; }
    .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
    .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
    .text-base { font-size: 1rem; line-height: 1.5rem; }
    .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
    .text-xs { font-size: 0.75rem; line-height: 1rem; }
    .font-bold { font-weight: 700; }
    .font-semibold { font-weight: 600; }
    .font-extrabold { font-weight: 800; }
    .text-blue-50 { color: #eff6ff; }
    .text-blue-100 { color: #dbeafe; }
    .text-blue-200 { color: #bfdbfe; }
    .text-blue-300 { color: #93c5fd; }
    .text-yellow-100 { color: #fef3c7; }
    .text-yellow-200 { color: #fde68a; }
    .text-yellow-300 { color: #fde047; }
    .text-yellow-400 { color: #facc15; }
    .text-green-100 { color: #dcfce7; }
    .text-green-300 { color: #86efac; }
    .text-green-400 { color: #4ade80; }
    .text-red-400 { color: #f87171; }
    .text-red-600 { color: #dc2626; }
    .text-purple-300 { color: #c4b5fd; }
    .text-pink-300 { color: #f9a8d4; }
    .text-orange-300 { color: #fdba74; }
    .bg-blue-700 { background-color: #1d4ed8; }
    .bg-blue-800 { background-color: #1e40af; }
    .bg-blue-900 { background-color: #1e3a8a; }
    .bg-green-700 { background-color: #15803d; }
    .bg-green-800 { background-color: #166534; }
    .bg-red-600 { background-color: #dc2626; }
    .bg-red-700 { background-color: #b91c1c; }
    .bg-yellow-50 { background-color: #fefce8; }
    .bg-gradient-to-r { background-image: linear-gradient(to right, var(--tw-gradient-stops)); }
    .from-blue-500 { --tw-gradient-from: #3b82f6; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(59, 130, 246, 0)); }
    .to-purple-600 { --tw-gradient-to: #9333ea; }
    .from-green-400 { --tw-gradient-from: #4ade80; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(74, 222, 128, 0)); }
    .to-blue-500 { --tw-gradient-to: #3b82f6; }
    .from-yellow-400 { --tw-gradient-from: #facc15; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(250, 204, 21, 0)); }
    .to-orange-500 { --tw-gradient-to: #f97316; }
    .from-pink-400 { --tw-gradient-from: #f472b6; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(244, 114, 182, 0)); }
    .to-red-500 { --tw-gradient-to: #ef4444; }
    .from-purple-400 { --tw-gradient-from: #c084fc; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(192, 132, 252, 0)); }
    .to-pink-500 { --tw-gradient-to: #ec4899; }
    .hover\\:bg-blue-700:hover { background-color: #1d4ed8; }
    .hover\\:bg-blue-800:hover { background-color: #1e40af; }
    .hover\\:bg-green-800:hover { background-color: #166534; }
    .hover\\:bg-red-700:hover { background-color: #b91c1c; }
    .cursor-pointer { cursor: pointer; }
    .transition { transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
    .transition-all { transition-property: all; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
    .transform { transform: translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }
    .hover\\:scale-105:hover { --tw-scale-x: 1.05; --tw-scale-y: 1.05; }
    .hover\\:shadow-xl:hover { box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }
    .opacity-75 { opacity: 0.75; }
    .opacity-90 { opacity: 0.9; }
    
    /* FontAwesome Icons (inline fallback) */
    .icon { display: inline-block; width: 1em; height: 1em; text-align: center; }
    .icon-graduation::before { content: "üéì"; }
    .icon-chart::before { content: "üìä"; }
    .icon-trophy::before { content: "üèÜ"; }
    .icon-star::before { content: "‚≠ê"; }
    .icon-book::before { content: "üìö"; }
    .icon-target::before { content: "üéØ"; }
    .icon-brain::before { content: "üß†"; }
    .icon-certificate::before { content: "üìú"; }
    .icon-cubes::before { content: "üß©"; }
    .icon-search::before { content: "üîç"; }
    .icon-pen::before { content: "‚úçÔ∏è"; }
    .icon-lock::before { content: "üîí"; }
    .icon-unlock::before { content: "üîì"; }
    .icon-check::before { content: "‚úÖ"; }
    .icon-fire::before { content: "üî•"; }
    .icon-rocket::before { content: "üöÄ"; }
    .icon-diamond::before { content: "üíé"; }
    .icon-chevron-down::before { content: "‚ñº"; }
    .icon-chevron-right::before { content: "‚ñ∂"; }
    
    /* Phase Card Styles */
    .phase-card {
      background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
      border-radius: 1rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      overflow: hidden;
    }
    .phase-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
    }
    
    .phase-header {
      padding: 1.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .phase-header:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .phase-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease, padding 0.4s ease;
      background: #1a2236 !important;
      color: #dbeafe !important;
    }
    .phase-content.expanded {
      max-height: 500px;
      padding: 1.5rem;
    }
    
    .phase-stats {
      background: #28304a !important;
      color: #dbeafe !important;
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 1rem;
      border-left: 4px solid #0ea5e9;
    }
    
    .phase-badge {
      display: inline-flex;
      align-items: center;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    .phase-badge.locked {
      background: #64748b;
      color: white;
    }
    .phase-badge.unlocked {
      background: #22c55e;
      color: white;
    }
    .phase-badge.completed {
      background: linear-gradient(90deg, #facc15, #22c55e);
      color: #1f2937;
    }
    
    .lesson-item {
      background: #28304a !important;
      color: #dbeafe !important;
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 1rem;
      border-left: 4px solid #3b82f6;
    }
    
    .complete-phase-btn {
      background: linear-gradient(90deg, #22c55e, #16a34a);
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-size: 0.875rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
    }
    .complete-phase-btn:hover {
      background: linear-gradient(90deg, #16a34a, #15803d);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
    }
    .complete-phase-btn.completed {
      background: linear-gradient(90deg, #facc15, #f59e0b);
      color: #1f2937;
    }
    
    .chevron {
      transition: transform 0.3s ease;
    }
    .phase-card.expanded .chevron {
      transform: rotate(90deg);
    }
    
    /* Badge Achievement Styles */
    .achievement-badge {
      display: inline-flex;
      align-items: center;
      background: linear-gradient(135deg, #facc15, #f59e0b);
      color: #1f2937;
      padding: 0.5rem 1rem;
      border-radius: 9999px;
      font-size: 0.875rem;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
      animation: bounce-in 0.6s ease;
    }
    
    @keyframes bounce-in {
      0% { transform: scale(0); opacity: 0; }
      50% { transform: scale(1.1); opacity: 0.8; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    /* Progress Stats */
    .stat-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 0.75rem;
      margin-bottom: 1rem;
    }
    .stat-item {
      background: #28304a !important;
      color: #dbeafe !important;
      padding: 0.75rem;
      border-radius: 0.5rem;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }
    .stat-label {
      font-size: 0.75rem;
      color: #93c5fd !important;
      font-weight: 500;
    }
    .stat-value {
      font-size: 1.25rem;
      font-weight: 700;
      color: #dbeafe !important;
    }
    .stat-value.positive { color: #22c55e !important; }
    .stat-value.negative { color: #ef4444 !important; }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .phase-header { padding: 1rem; }
      .phase-content.expanded { padding: 1rem; }
      .phase-card h3 { font-size: 1.125rem; }
      .stat-grid { grid-template-columns: repeat(2, 1fr); }
    }
    .container { width: 100%; margin-left: auto; margin-right: auto; padding-left: 1rem; padding-right: 1rem; }
    @media (min-width: 768px) {
      .container { max-width: 768px; }
      .md\\:flex-row { flex-direction: row; }
      .md\:w-2\/3 { width: 66.666667%; }
      .md\:w-1\/3 { width: 33.333333%; }
      .md\\:text-4xl { font-size: 2.25rem; line-height: 2.5rem; }
      .md\\:mt-0 { margin-top: 0; }
      .md\\:gap-2 { gap: 0.5rem; }
    }
    @media (min-width: 1024px) {
      .container { max-width: 1024px; }
    }
    @media (min-width: 1280px) {
      .container { max-width: 1280px; }
    }
    /* Tab Styles */
    .tab-active {
      background: linear-gradient(90deg, #2563eb 0%, #facc15 100%) !important;
      color: #fff !important;
      font-weight: 700;
      box-shadow: 0 2px 10px 0 rgba(80,0,120,0.08);
    }
    .tab-btn {
      transition: all 0.2s;
      font-weight: 600;
      letter-spacing: 0.04em;
    }
    /* Section Card Styles */
    .manual-section {
      background: #1a2236 !important;
      color: #dbeafe !important;
      border: 1px solid #28304a;
      box-shadow: 0 3px 18px 0 rgba(90,150,255,0.08);
      transition: box-shadow 0.2s;
    }
    .manual-section:hover {
      box-shadow: 0 8px 32px 0 rgba(120, 80, 255, 0.14);
      border-color: #2563eb;
    }
    /* Badges */
    .badge {
      display: inline-block;
      background: linear-gradient(90deg, #10b981 0%, #2563eb 100%);
      color: #fff;
      border-radius: 9999px;
      padding: 0.25em 0.9em;
      font-size: 1em;
      font-weight: 700;
      margin-left: 0.6em;
      vertical-align: middle;
      letter-spacing: 0.04em;
      box-shadow: 0 2px 4px 0 #2563eb22;
    }
    /* Readable form labels and text */
    label, input, select, textarea, .text-blue-900, .text-blue-100, .text-blue-700, .text-yellow-800 {
      color: #dbeafe !important;
    }
    /* Unified Input, Select, Textarea Styles (Light-on-Dark) */
    input, select, textarea {
      background: #192038 !important;
      color: #dbeafe !important;
      border: 1px solid #28304a !important;
      border-radius: 0.375rem;
      padding: 0.5rem 0.75rem;
      font-size: 1rem;
      font-family: 'Montserrat', system-ui, sans-serif;
      transition: border 0.2s, outline 0.2s;
      outline: none;
      box-shadow: none;
      width: 100%;
      min-width: 0;
      max-width: 100%;
      box-sizing: border-box;
    }
    input:focus, select:focus, textarea:focus {
      outline: 2px solid #facc15 !important;
      background: #232946 !important;
      color: #facc15 !important;
      border-color: #facc15 !important;
    }
    input[type="date"], input[type="number"] { 
      -webkit-color-scheme: dark; 
      color-scheme: dark; 
    }
    select option { background: #232946; color: #dbeafe; }
    textarea { min-height: 2.5rem; resize: vertical;}
    ::placeholder { color: #b3c2e0 !important; opacity: 1 !important;}

    /* Journal Table Styles */
    table#journal-table th, table#journal-table td {
      border: 1px solid #28304a;
      padding: 8px;
      text-align: left;
    }
    table#journal-table th {
      background: #1e40af !important;
      color: #dbeafe !important;
      font-weight: 700;
    }
    table#journal-table tr:nth-child(even) {
      background: #28304a;
    }
    table#journal-table tr:nth-child(odd) {
      background: #1a2236;
    }
    table#journal-table {
      margin-top: 2rem;
      margin-bottom: 2rem;
      border-radius: 10px;
      overflow: hidden;
      width: 100%;
    }
    /* Journal Form Styles (Legacy support for old form) */
    #journal-form input, #journal-form select, #journal-form button {
      margin-right: 8px;
      margin-bottom: 8px;
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid #28304a;
      background: #192038;
      color: #dbeafe;
      font-size: 1em;
    }
    #journal-form button {
      background: linear-gradient(90deg, #facc15 0%, #2563eb 100%);
      color: #232946;
      font-weight: 700;
      cursor: pointer;
      border: none;
      transition: background 0.15s;
    }
    #journal-form button:hover {
      background: linear-gradient(90deg, #2563eb 0%, #facc15 100%);
      color: #fff;
    }
    /* Journal Table/Row Animation & UX */
    .highlight-row { background: #facc1530 !important; transition: background 0.7s;}
    .animate-pulse { animation: pulse 0.9s cubic-bezier(0.4, 0, 0.6, 1) 1;}
    @keyframes pulse { 
      0%,100%{box-shadow:0 0 0 0 #facc1544;} 
      70%{box-shadow:0 0 14px 6px #facc1560;}
    }
    .animate-bounce { animation: badgeBounce 0.55s cubic-bezier(.18,1.3,.57,.99) 1;}
    @keyframes badgeBounce { 
      0%{transform:scale(1);} 
      25%{transform:scale(1.13);} 
      40%{transform:scale(0.96);} 
      70%{transform:scale(1.07);} 
      100%{transform:scale(1);}
    }
    .journal-badge.locked { opacity: 0.35; filter: grayscale(0.82); border: 2px dashed #64748b; color: #64748b; pointer-events: none;}
    .journal-pnl-readonly {
      background: #28304a !important;
      opacity: 0.7;
    }
   /* Make completed phase text blue for readability */
.syllabus-phase-card[data-complete="true"] .syllabus-phase-title,
.syllabus-phase-card[data-complete="true"] .syllabus-phase-desc {
  color: #2563eb !important;
} 
  </style>
</head>
<body>
  <header class="bg-[#232946] shadow-lg py-4 mb-8 border-b border-blue-900">
    <div class="container mx-auto px-4 flex flex-col md:flex-row justify-between items-center gap-2">
      <div class="flex items-center space-x-5">
        <img src="/public/griffin-rise-log.png" alt="Griffin's Rise Trading Journal Logo"
          class="h-20 w-20 rounded-full shadow-xl ring-4 ring-blue-500 ring-opacity-60 bg-white object-contain profile-img" />
        <div>
          <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight text-blue-100 brand-font">
            Griffin's Rise: <span class="text-yellow-400">Advanced Trading Journal</span>
          </h1>
          <span class="badge mt-2 ml-1 align-middle text-base pro-badge">PRO EDITION</span>
        </div>
      </div>
      <nav class="flex flex-wrap gap-1 md:gap-2 items-center mt-4 md:mt-0">
        <button id="onboardingTab" class="tab-btn bg-purple-700 hover:bg-purple-600 px-4 py-2 rounded transition hidden">CeFi/DeFi Onboarding</button>
        <button id="educationTab" class="tab-btn bg-gray-700 hover:bg-blue-800 px-4 py-2 rounded transition hidden">Education</button>
        <button id="syllabusTab" class="tab-btn bg-blue-900 hover:bg-blue-700 px-4 py-2 rounded transition hidden">Syllabus</button>
        <button id="trainingManualTab" class="tab-btn bg-yellow-700 hover:bg-yellow-600 px-4 py-2 rounded transition hidden">Training Manual</button>
        <button id="journalTab" class="tab-btn bg-gray-700 hover:bg-blue-900 px-4 py-2 rounded transition hidden">Journal</button>
        <button id="dashboardTab" class="tab-btn bg-gray-700 hover:bg-blue-900 px-4 py-2 rounded transition hidden">Dashboard</button>
        <button id="loginTab" class="tab-btn bg-green-700 hover:bg-green-600 px-4 py-2 rounded transition">Register / Login</button>
        <button id="logoutBtn" class="tab-btn bg-red-700 hover:bg-red-800 px-4 py-2 rounded transition hidden">Logout</button>
      </nav>
    </div>
  </header>
  <main class="container mx-auto px-4 max-w-4xl">
    <!-- Login/Register -->
    <section id="loginContent">
      <div class="manual-section p-6 rounded-lg shadow-lg max-w-md mx-auto mt-8">
        <h2 class="text-2xl font-bold mb-4 text-green-400 text-center">Register / Login</h2>
        <form id="loginForm" class="space-y-4">
          <div>
            <label class="block mb-1" for="login-username">Username</label>
            <input id="login-username" type="text" class="w-full px-3 py-2 rounded" required />
          </div>
          <div>
            <label class="block mb-1" for="login-password">Password</label>
            <input id="login-password" type="password" class="w-full px-3 py-2 rounded" required />
          </div>
          <div class="flex justify-between items-center">
            <button type="submit" class="bg-green-700 hover:bg-green-800 text-white px-4 py-2 rounded font-semibold transition">Login</button>
            <button type="button" id="switchToRegister" class="text-green-300 text-sm hover:underline">Register</button>
          </div>
        </form>
        <form id="registerForm" class="space-y-4 hidden">
          <div>
            <label class="block mb-1" for="register-username">Username</label>
            <input id="register-username" type="text" class="w-full px-3 py-2 rounded" required />
          </div>
          <div>
            <label class="block mb-1" for="register-password">Password</label>
            <input id="register-password" type="password" class="w-full px-3 py-2 rounded" required />
          </div>
          <div>
            <label class="block mb-1" for="register-confirm">Confirm Password</label>
            <input id="register-confirm" type="password" class="w-full px-3 py-2 rounded" required />
          </div>
          <div class="flex justify-between items-center">
            <button type="submit" class="bg-green-700 hover:bg-green-800 text-white px-4 py-2 rounded font-semibold transition">Register</button>
            <button type="button" id="switchToLogin" class="text-green-300 text-sm hover:underline">Login</button>
          </div>
        </form>
        <div id="loginMessage" class="mt-4 text-center text-sm text-green-400"></div>
      </div>
    </section>

   <!-- Education Tab -->
<section id="educationContent" class="hidden">
  <div class="manual-section p-8 rounded-xl shadow mb-8">
    <div class="flex flex-col md:flex-row items-center gap-8">
      <div class="md:w-2/3">
        <h2 class="text-3xl font-extrabold mb-3 text-blue-100">Education</h2>
        <ul class="mt-4 list-disc ml-8 text-blue-50 text-base space-y-1">
          <li>
            Explore the full curriculum in the
            <span class="text-yellow-300 font-semibold">Syllabus</span> tab.
          </li>
          <li>
            Track your lesson progress and earn achievement badges for mastery.
          </li>
          <li>
            Access detailed, actionable how-to guides in the Training Manual.
          </li>
        </ul>
        <div class="mt-6 bg-blue-900/90 border-l-4 border-blue-400 px-4 py-3 rounded">
          <b class="text-yellow-200">Tip:</b>
          <span class="text-blue-100">
            Use the <span class="text-yellow-300">Training Manual</span> for step-by-step checklists. All progress is saved automatically.
          </span>
        </div>
      </div>
      <div class="md:w-1/3 flex justify-center">
        <img src="/public/griffin-rise-log.png"
             alt="Griffin's Rise Trading Journal Logo"
             class="w-[320px] max-w-full h-auto rounded-xl shadow ring-8 ring-yellow-200 ring-opacity-80 bg-white object-contain" />
      </div>
    </div>
  </div>
</section>
<!-- Griffin's Rise Trading Mastery Syllabus (Pro Edition) -->
<section id="syllabusContent">
  <div class="syllabus-container">
    <!-- Header -->
    <div class="syllabus-header">
      <div class="syllabus-header-row">
        <span class="icon"><i class="fas fa-graduation-cap"></i></span>
        <h2>Syllabus: Griffin's Rise Trading Mastery</h2>
        <span class="syllabus-badge">Pro Edition 2025</span>
      </div>
      <div class="syllabus-progress-box">
        <div class="syllabus-progress-label-row">
          <span class="icon"><i class="fas fa-chart-line"></i></span>
          <h3>Your Learning Progress</h3>
        </div>
        <div class="syllabus-progress-bar-bg">
          <div id="syllabus-progress-bar" class="syllabus-progress-bar"></div>
        </div>
        <div class="syllabus-progress-footer">
          <span id="syllabus-progress-label">0% Complete</span>

        </div>
      </div>
    </div>
    <!-- Achievement Badges -->
    <div class="syllabus-badges">
      <h3><span class="icon"><i class="fas fa-trophy"></i></span> Achievement Badges</h3>
      <div id="syllabus-completed-labels" class="syllabus-completed-labels"></div>
    </div>
    <!-- PHASES -->
    <div id="syllabus-phases"></div>
    <!-- Footer Tips -->
    <div class="syllabus-footer">
      <div class="syllabus-footer-row">
        <span class="icon"><i class="fas fa-rocket"></i></span>
        <h3>Pro Tips for Success</h3>
      </div>
      <div class="syllabus-footer-tips">
        <div>‚Ä¢ Complete phases in order for optimal learning progression</div>
        <div>‚Ä¢ Practice with paper trading before going live</div>
        <div>‚Ä¢ Join our community for peer support and advanced strategies</div>
      </div>
      <div class="syllabus-footer-resources">
        <span class="icon"><i class="fas fa-fire"></i></span>
        Need more resources? Visit
        <a href="https://www.babypips.com/" target="_blank" rel="noopener">BabyPips School</a>
        and
        <a href="https://www.tradingview.com/" target="_blank" rel="noopener">TradingView Ideas</a>
      </div>
    </div>
  </div>
</section>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<style>
  .syllabus-container {max-width:900px;margin:0 auto;padding:2rem;}
  .syllabus-header {background: linear-gradient(90deg, #2563eb 0%, #1e293b 100%); border-radius: 1rem; padding:2rem; margin-bottom:2rem; box-shadow: 0 4px 24px 0 #0002;}
  .syllabus-header-row {display:flex;align-items:center;gap:1rem; margin-bottom:1rem;}
  .syllabus-header-row h2 {font-size:2rem;font-weight:800;color:#fff;flex:1;}
  .syllabus-badge {background:#1e293b;color:#ffe066;padding:0.5rem 1.5rem; border-radius:9999px; font-weight:700; font-size:.95rem; border:1px solid #172554; box-shadow:0 2px 6px #0002;}
  .syllabus-progress-box {background:rgba(37,99,235,.18);border-radius:0.8rem;padding:1rem;}
  .syllabus-progress-label-row {display:flex;align-items:center;gap:0.8rem;margin-bottom:0.5rem;}
  .syllabus-progress-label-row h3 {font-size:1.1rem;font-weight:700;color:#fff;}
  .syllabus-progress-bar-bg {width:100%;background:#17255450;border-radius:9999px;height:0.85rem;margin-bottom:0.5rem;overflow:hidden;}
  .syllabus-progress-bar {background:linear-gradient(90deg,#ffe066,#f59e42);height:0.85rem;transition:width .4s; width:0%;border-radius:9999px;}
  .syllabus-progress-footer {display:flex;justify-content:space-between;align-items:center;}
  #syllabus-progress-label {color:#fff;font-weight:500;font-size:0.93rem}
  #syllabus-reset-btn {background:#dc2626;color:#fff;padding:0.35rem 1rem;border-radius:0.4rem;font-size:0.82rem;font-weight:600;cursor:pointer;border:none;transition:.2s;}
  .syllabus-badges {margin-bottom:2rem;}
  .syllabus-badges h3 {font-size:1.15rem;font-weight:700;color:#ffe066;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem;}
  .syllabus-completed-labels {display:flex;flex-wrap:wrap;gap:0.65rem;}
  .syllabus-badge-label { color:#172554; background: #ffe066; border-radius: 4px; font-size: 0.96rem; font-weight: 700; padding: 0.22rem 0.7rem 0.2rem 0.7rem;display:flex;align-items:center;gap:.4rem;}
  .syllabus-phase-card {
    background: linear-gradient(110deg, #1e293b 80%, #2563eb 100%);
    border-radius: 1rem;
    margin-bottom: 2rem;
    box-shadow: 0 2px 8px #0002;
    overflow: hidden;
    transition:.2s;
  }
  .syllabus-phase-card[data-complete="true"] {
    background: linear-gradient(90deg, #ffe066 0%, #f59e42 100%);
    box-shadow: 0 3px 12px #f59e4244;
  }
  .syllabus-phase-header {
    display:flex;
    align-items:center;
    gap:1rem;
    cursor:pointer;
    padding:1.5rem 1.3rem 1.2rem 1.3rem;
    -webkit-user-select:none; user-select:none;
    background:rgba(255,255,255,0.04);
    transition:.2s;
  }
  .syllabus-phase-header:hover { background:rgba(255,255,255,0.07);}
  .syllabus-phase-title {font-size:1.18rem;font-weight:700;color:#fff;}
  .syllabus-phase-desc {color:#dbeafe;font-size:0.98rem;margin-top:.1rem;}
  .syllabus-phase-status {margin-left:auto;font-size:0.83rem;font-weight:600;color:#e0e7ef;background:rgba(30,41,59,.65);border-radius:9999px;padding:.2rem 1rem;border:1px solid #2563eb88;}
  .syllabus-phase-card[data-complete="true"] .syllabus-phase-status {color:#1e293b;background:#ffe066;border-color:#ffd700;}
  .syllabus-chevron {margin-left:1.1rem;color:#fff;font-size:1.15rem;transition:transform .22s;}
  .syllabus-phase-card[data-open="true"] .syllabus-chevron {transform:rotate(90deg);}
  .syllabus-phase-content {background: rgba(30,41,59,0.95);padding:1.5rem 1.4rem 1.4rem 2.7rem;color:#fff;font-size:.97rem;display: none;border-top: 1px solid #2563eb55;animation: syllabus-fadein .35s;}
  .syllabus-phase-card[data-open="true"] .syllabus-phase-content { display:block; }
  @keyframes syllabus-fadein { from { opacity:0; transform:translateY(-8px);} to { opacity:1; transform:translateY(0);}}
  .syllabus-lesson {margin-bottom:1.5rem;background:rgba(37,99,235,.13);border-left:4px solid #2563eb;border-radius:0.5rem;padding:1.1rem 1rem 1rem 1.1rem;}
  .syllabus-lesson:last-child { margin-bottom:0; }
  .syllabus-lesson-title { font-weight:600; color:#fff; margin-bottom:0.25rem; }
  .syllabus-lesson-desc { color:#e0e7ef; font-size:0.98rem; margin-bottom:0.2rem; }
  .syllabus-lesson ul { margin:0.4rem 0 0.4rem 1.2rem; color:#93c5fd; font-size:0.95rem;}
  .syllabus-lesson-assignment { color:#fbbf24; font-size:0.96rem; margin-bottom:0.19rem;}
  .syllabus-lesson-resources { color:#a5b4fc; font-size:0.93rem; margin-bottom:0.3rem;}
  .syllabus-lesson-resources a { color:#ffe066; text-decoration:underline; margin-right:0.5rem; }
  .syllabus-lesson-badges { margin-top:0.4rem;}
  .syllabus-lesson-badge {
    display:inline-flex;align-items:center;gap:0.3rem;background:#172554;color:#ffe066;padding:0.15rem 0.6rem;border-radius:999px;font-size:0.84rem;font-weight:600;margin-right:0.5rem;
  }
  .syllabus-goal { color:#bae6fd;font-size:0.98rem;margin:0.8rem 0 0.2rem 0;font-style:italic;}
  .syllabus-complete-btn {background:#16a34a;color:#fff;font-weight:700;border:none;padding:0.5rem 1.7rem;font-size:1rem;border-radius:0.5rem;margin-top:0.6rem;cursor:pointer;box-shadow:0 2px 7px #0001;transition:.18s;}
  .syllabus-complete-btn:active { background:#166534;}
  .syllabus-badge-img { width:1.7rem; height:1.7rem; border-radius:0.5rem; border:1px solid #ffe066; background:#fff;margin-right:0.4rem;}
  .syllabus-footer {margin-top:2rem; background:#172554; border-radius:0.7rem; padding:1.3rem; box-shadow:0 3px 9px #0001;}
  .syllabus-footer-row {display:flex;align-items:center;gap:.7rem;margin-bottom:.7rem;}
  .syllabus-footer h3 {font-size:1rem;font-weight:700;color:#fff;}
  .syllabus-footer-tips {color:#bae6fd;font-size:0.97rem;margin-bottom:.7rem;}
  .syllabus-footer-resources {margin-top:0.5rem;color:#dbeafe;font-size:0.88rem;}
  .syllabus-footer-resources a {color:#ffe066;text-decoration:underline;}
  
  /* Utility classes for inline styles */
  .profile-img { min-width: 120px; }
  .brand-font { font-family: Montserrat, sans-serif; }
  .pro-badge { background: linear-gradient(90deg, #f59e42 0%, #2563eb 100%); color: #fff; }
  .journal-pnl-readonly { background: #28304a !important; opacity: 0.7; }
  .responsive-video { padding-bottom: 56.25%; height: 0; }
  .edit-btn { margin-right: 6px; background: #2563eb; color: #fff; padding: 2px 8px; border-radius: 4px; cursor: pointer; }
  .delete-btn { background: #dc2626; color: #fff; padding: 2px 8px; border-radius: 4px; cursor: pointer; }
  .overflow-table { max-width: 80rem; min-width: 340px; overflow-x: auto; }
  .constrained-width { max-width: 64rem; margin: auto; }
  .manual-max-width { max-width: 100rem; }
</style>
<script>
const syllabus = [
  {
    id: "lesson1",
    phase: "Foundation",
    phaseNumber: 1,
    lessonNumber: 1,
    title: "Foundation, Mindset, & Platform Choices",
    description:
      "Master the pillars of successful trading, develop a professional mindset, and choose your trading platform.",
    objectives: [
      "Understand the three pillars: Risk Management, Probabilistic Thinking, Deep Skepticism.",
      "Learn to formulate a short thesis.",
      "Compare centralized (CeFi, e.g. MEXC) and decentralized (DeFi, e.g. Hyperliquid) platforms for short selling.",
    ],
    assignment: "Analyze 3-5 failed tokens using MEXC and Dexscreener.",
    resources: [
      { title: "MEXC Exchange", url: "https://www.mexc.com/" },
      { title: "Dexscreener", url: "https://dexscreener.com/" },
      { title: "Hyperliquid Exchange", url: "https://app.hyperliquid.xyz/trade" },
      {
        title: "Probabilistic Thinking (Farnam Street)",
        url: "https://fs.blog/probabilistic-thinking/",
      },
    ],
    badges: [
      {
        id: "starter",
        name: "Starter Badge",
        imageUrl: "https://cdn-icons-png.flaticon.com/512/1828/1828884.png"
      },
    ]
  },
  {
    id: "lesson2",
    phase: "Foundation",
    phaseNumber: 1,
    lessonNumber: 2,
    title: "Risk Management Mastery",
    description:
      "Discover the science of risk and position sizing for short sellers.",
    objectives: [
      "Learn advanced position sizing.",
      "Apply risk management to live trades.",
      "Avoid common risk pitfalls.",
    ],
    assignment: "Calculate risk for 3 sample trades.",
    resources: [
      {
        title: "BabyPips Position Size Calculator",
        url: "https://www.babypips.com/tools/position-size-calculator",
      },
      {
        title: "Risk Management for Traders (Investopedia)",
        url: "https://www.investopedia.com/articles/trading/09/risk-management.asp",
      },
    ],
    badges: [
      {
        id: "risk-ninja",
        name: "Risk Ninja",
        imageUrl: "https://cdn-icons-png.flaticon.com/512/1055/1055687.png"
      },
    ]
  },
  {
    id: "lesson3",
    phase: "Foundation",
    phaseNumber: 1,
    lessonNumber: 3,
    title: "Platform Mastery & Tool Setup",
    description:
      "Get hands-on with your chosen trading platform. Learn to use critical charting and research tools.",
    objectives: [
      "Setup accounts on MEXC and Hyperliquid.",
      "Explore Dexscreener and TradingView for charting.",
      "Learn basic order types for short selling.",
    ],
    assignment: "Setup demo accounts and place test orders.",
    resources: [
      { title: "TradingView", url: "https://www.tradingview.com/" },
      { title: "MEXC Guide", url: "https://www.mexc.com/support" },
      {
        title: "Hyperliquid Docs",
        url: "https://hyperliquid.gitbook.io/hyperliquid-docs",
      },
    ],
    badges: [
      {
        id: "toolmaster",
        name: "Tool Master",
        imageUrl: "https://cdn-icons-png.flaticon.com/512/2659/2659366.png"
      },
    ]
  },
  {
    id: "lesson4",
    phase: "Short Thesis & Discovery",
    phaseNumber: 2,
    lessonNumber: 4,
    title: "Short Thesis Discovery & Analysis",
    description:
      "Learn how to discover, analyze, and validate short opportunities using real-time data and research.",
    objectives: [
      "Identify failed tokens with strong short setups.",
      "Use Dexscreener and CoinGecko for live analysis.",
      "Apply skepticism and research skills for thesis validation.",
    ],
    assignment: "Submit 2 short thesis analyses using live tokens.",
    resources: [
      { title: "CoinGecko", url: "https://www.coingecko.com/" },
      {
        title: "Crypto Fundamentals (Binance)",
        url: "https://academy.binance.com/en/articles/a-guide-to-cryptocurrency-fundamental-analysis",
      },
    ],
    badges: [
      {
        id: "thesis-hunter",
        name: "Thesis Hunter",
        imageUrl: "https://cdn-icons-png.flaticon.com/512/3135/3135715.png"
      },
    ]
  },
  {
    id: "lesson5",
    phase: "Short Thesis & Discovery",
    phaseNumber: 2,
    lessonNumber: 5,
    title: "Red Flags & Scam Spotting",
    description:
      "Spot common red flags in tokens and projects to avoid traps.",
    objectives: [
      "Recognize rug pulls, exit scams, and fake teams.",
      "Understand liquidity risks.",
      "Use research tools for scam detection.",
    ],
    assignment: "Submit a list of 5 red flags from recent rug pulls.",
    resources: [
      { title: "RugDoc.io", url: "https://rugdoc.io/" },
      {
        title: "Scam and Fraud (Tech.co)",
        url: "https://tech.co/news/how-to-avoid-crypto-scams",
      },
    ],
    badges: [
      {
        id: "scam-spotter",
        name: "Scam Spotter",
        imageUrl: "https://cdn-icons-png.flaticon.com/512/1694/1694363.png"
      },
    ]
  },
  {
    id: "lesson6",
    phase: "Execution & Journaling",
    phaseNumber: 3,
    lessonNumber: 6,
    title: "Short Entry Execution",
    description: "Execute short trades with precision and confidence.",
    objectives: [
      "Identify optimal entry points.",
      "Set stop-loss and take-profit orders.",
      "Understand slippage and order execution risks.",
    ],
    assignment: "Log 2 short trades in your journal.",
    resources: [
      {
        title: "Short Selling Guide (Tastycrypto)",
        url: "https://www.tastycrypto.com/blog/short-crypto-strategies/",
      },
      {
        title: "Trading Slippage Explained",
        url: "https://www.investopedia.com/terms/s/slippage.asp",
      },
    ],
    badges: [
      {
        id: "executor",
        name: "Executor",
        imageUrl: "https://cdn-icons-png.flaticon.com/512/685/685352.png"
      },
    ]
  },
  {
    id: "lesson7",
    phase: "Execution & Journaling",
    phaseNumber: 3,
    lessonNumber: 7,
    title: "Journaling for Improvement",
    description:
      "Turn your trading into a science by tracking every detail.",
    objectives: [
      "Log every trade with thesis, emotion, and regime.",
      "Review and reflect on trade outcomes.",
      "Use journaling data to spot patterns and improve.",
    ],
    assignment: "Journal 3 trades and write a reflection.",
    resources: [
      {
        title:
          "You can track and log every trade in the Advanced Trading Journal provided in this application.",
        url: ""
      },
    ],
    badges: [
      {
        id: "scientist",
        name: "Trading Scientist",
        imageUrl: "https://cdn-icons-png.flaticon.com/512/4515/4515458.png"
      },
    ]
  },
  {
    id: "lesson8",
    phase: "Advanced Scenarios & Psychology",
    phaseNumber: 4,
    lessonNumber: 8,
    title: "Trader Psychology & FOMO",
    description:
      "Master your emotions and avoid psychological traps like FOMO.",
    objectives: [
      "Recognize emotional triggers in trading.",
      "Develop discipline and rules for high-volatility situations.",
      "Document emotional state in your journal.",
    ],
    assignment: "Write about a time you experienced FOMO and its impact.",
    resources: [
      {
        title: "Trading Psychology (BabyPips)",
        url: "https://www.babypips.com/trading/psychology",
      },
      {
        title: "FOMO in Trading (Investopedia)",
        url: "https://www.investopedia.com/fomo-investing-protect-your-money-11757950",
      },
    ],
    badges: [
      {
        id: "mindmaster",
        name: "Mind Master",
        imageUrl: "https://cdn-icons-png.flaticon.com/512/2814/2814666.png"
      },
    ]
  },
  {
    id: "lesson9",
    phase: "Advanced Scenarios & Psychology",
    phaseNumber: 4,
    lessonNumber: 9,
    title: "Dealing with Losses & Tilt",
    description:
      "Develop strategies to handle losses and avoid revenge trading.",
    objectives: [
      "Understand the impact of losing streaks.",
      "Create a personal rule for loss limits.",
      "Journal and reflect on a losing trade.",
    ],
    assignment: "Write your loss limit rule and journal a recent loss.",
    resources: [
      {
        title: "Revenge Trading (Superareas)",
        url: "https://superareas.com/pdf/3of7-RevengeonMarket.pdf",
      },
      {
        title: "Handling Trading Losses (Day Trading)",
        url: "https://www.daytrading.com/deal-with-trading-losses",
      },
    ],
    badges: [
      {
        id: "tiltproof",
        name: "Tilt Proof",
        imageUrl: "https://cdn-icons-png.flaticon.com/512/1292/1292286.png"
      },
    ]
  },
  {
    id: "lesson10",
    phase: "Mastery & Peer Review",
    phaseNumber: 5,
    lessonNumber: 10,
    title: "Peer Review & Community",
    description:
      "Participate in peer review and community challenges for advanced learning.",
    objectives: [
      "Review and critique peer trade journals.",
      "Share and discuss trade ideas in community forums.",
      "Collaborate on finding short setups.",
    ],
    assignment: "Peer review 2 journals and share an idea.",
    resources: [
      {
        title: "TradingView Public Chats",
        url: "https://www.tradingview.com/chat/",
      },
      {
        title: "Discord Trading Communities",
        url: "https://discord.com/invite/trading",
      },
    ],
    badges: [
      {
        id: "peerreviewer",
        name: "Peer Reviewer",
        imageUrl: "https://cdn-icons-png.flaticon.com/512/1828/1828919.png"
      },
    ]
  },
  {
    id: "lesson11",
    phase: "Mastery & Peer Review",
    phaseNumber: 5,
    lessonNumber: 11,
    title: "Final Project & Certification",
    description:
      "Demonstrate your mastery with a final project and earn your certification.",
    objectives: [
      "Complete a full trading journal for a month.",
      "Present your short thesis and trade outcomes.",
      "Reflect and submit for certification.",
    ],
    assignment: "Submit your journal, thesis, and reflection for review.",
    resources: [
      {
        title: "Sample Trading Journal Template (Google Sheets)",
        url: "https://docs.google.com/spreadsheets/d/1mVLyK5vN3vJw0n62V-xy5vJQf5bQj7IW/",
      },
    ],
    badges: [
      {
        id: "certified",
        name: "Certified Short Seller",
        imageUrl: "https://cdn-icons-png.flaticon.com/512/190/190411.png"
      },
    ]
  }
];
const phaseOrder = [
  { phase: "Foundation", title: "Phase 1: Foundation", desc: "Mindset, Platform, Risk Management", goal: "Build mental armor and technical foundation" },
  { phase: "Short Thesis & Discovery", title: "Phase 2: Short Thesis & Discovery", desc: "Analysis, Red Flags, Market Research", goal: "Master market research and thesis development" },
  { phase: "Execution & Journaling", title: "Phase 3: Execution & Journaling", desc: "Trade Entry, Documentation, Process", goal: "Execute trades with precision and discipline" },
  { phase: "Advanced Scenarios & Psychology", title: "Phase 4: Advanced Scenarios & Psychology", desc: "FOMO Control, Loss Management, Discipline", goal: "Develop unshakeable trading psychology" },
  { phase: "Mastery & Peer Review", title: "Phase 5: Mastery & Peer Review", desc: "Certification, Community, Advanced Analysis", goal: "Achieve professional trading certification" }
];
// Phase completion storage functions
function getLocalCompletedPhases() {
  return JSON.parse(localStorage.getItem("syllabusCompletedPhases") || "[]");
}
function setLocalCompletedPhases(arr) {
  localStorage.setItem("syllabusCompletedPhases", JSON.stringify(arr));
}

function getLocalCompletedPhases() {
  return JSON.parse(localStorage.getItem("syllabusCompletedPhases") || "[]");
}
function setLocalCompletedPhases(arr) {
  localStorage.setItem("syllabusCompletedPhases", JSON.stringify(arr));
}
function renderSyllabus() {
  const container = document.getElementById("syllabus-phases");
  container.innerHTML = "";
  const completed = getLocalCompletedPhases();
  phaseOrder.forEach((phaseObj, i) => {
    const lessons = syllabus.filter(l => l.phase === phaseObj.phase);
    const isComplete = completed.includes(i);
    const card = document.createElement("div");
    card.className = "syllabus-phase-card";
    card.dataset.open = "false";
    card.dataset.complete = isComplete ? "true" : "false";
    card.innerHTML = `
      <div class="syllabus-phase-header">
        <span class="icon"><i class="fas fa-cube"></i></span>
        <div>
          <div class="syllabus-phase-title">${phaseObj.title}</div>
          <div class="syllabus-phase-desc">${phaseObj.desc}</div>
        </div>
        <span class="syllabus-phase-status">${isComplete ? '<i class="fas fa-check-circle"></i> Completed' : '<i class="fas fa-lock"></i> Locked'}</span>
        <span class="syllabus-chevron"><i class="fas fa-chevron-right"></i></span>
      </div>
      <div class="syllabus-phase-content"></div>
    `;
    const content = card.querySelector(".syllabus-phase-content");
    lessons.forEach(lesson => {
      const badgeHtml = (lesson.badges||[]).map(b =>
        `<span class="syllabus-lesson-badge"><img class="syllabus-badge-img" src="${b.imageUrl}" alt="">${b.name}</span>`
      ).join('');
      content.innerHTML += `
        <div class="syllabus-lesson">
          <div class="syllabus-lesson-title">${lesson.lessonNumber}. ${lesson.title}</div>
          <div class="syllabus-lesson-desc">${lesson.description}</div>
          <ul>${lesson.objectives.map(o=>`<li>${o}</li>`).join('')}</ul>
          <div class="syllabus-lesson-assignment"><b>Assignment:</b> ${lesson.assignment}</div>
          <div class="syllabus-lesson-resources"><b>Resources:</b> ${
            lesson.resources.filter(r=>r.url).map(r=>
              `<a href="${r.url}" target="_blank">${r.title}</a>`
            ).join(' ')
          }</div>
          <div class="syllabus-lesson-badges">${badgeHtml}</div>
        </div>
      `;
    });
    content.innerHTML += `<div class="syllabus-goal"><span class="icon"><i class="fa fa-bullseye"></i></span><b>Goal:</b> ${phaseObj.goal}</div>
    <button class="syllabus-complete-btn" data-phase="${i}">${isComplete ? '<i class="fa fa-undo"></i> Unmark Complete' : '<i class="fa fa-check"></i> Mark Complete'}</button>`;
    // Accordion logic
    card.querySelector('.syllabus-phase-header').onclick = function() {
      document.querySelectorAll('.syllabus-phase-card').forEach((c) => {
        if(c!==card) c.dataset.open = "false";
      });
      card.dataset.open = card.dataset.open === "true" ? "false" : "true";
    };
    content.querySelector('.syllabus-complete-btn').onclick = function(e) {
      e.stopPropagation();
      let arr = getLocalCompletedPhases();
      if (arr.includes(i)) {
        // Remove from completed (unmark)
        arr = arr.filter(phase => phase !== i);
      } else {
        // Add to completed (mark)
        arr.push(i);
      }
      setLocalCompletedPhases(arr);
      renderSyllabus();
      updateProgress();
      updateBadges();
    };
    container.appendChild(card);
  });
  updateProgress();
  updateBadges();
}

// Update progress bar to show phase completion only (X/5 phases)
function updateProgress() {
  const completed = getLocalCompletedPhases();
  const totalPhases = phaseOrder.length; // Always 5 phases
  const percent = Math.floor(100 * completed.length / totalPhases);
  
  const progressBar = document.getElementById('syllabus-progress-bar');
  const progressLabel = document.getElementById('syllabus-progress-label');
  
  if (progressBar) {
    progressBar.style.width = percent + "%";
  }
  if (progressLabel) {
    progressLabel.innerText = `${completed.length}/${totalPhases} phases complete (${percent}%)`;
  }
}

function updateBadges() {
  const completed = getLocalCompletedPhases();
  const badgeContainer = document.getElementById('syllabus-completed-labels');
  badgeContainer.innerHTML = '';
  completed.forEach(idx => {
    const phase = phaseOrder[idx];
    badgeContainer.innerHTML += `<span class="syllabus-badge-label"><i class="fas fa-trophy"></i> ${phase.title}</span>`;
  });
}

document.addEventListener('DOMContentLoaded', function() {
  renderSyllabus();
  document.getElementById('syllabus-reset-btn').onclick = function() {
    if(confirm("Reset all syllabus progress?")) {
      setLocalCompletedPhases([]);
      renderSyllabus();
      updateProgress();
      updateBadges();
    }
  };
});
</script>
<!-- Training Manual -->
<!-- Training Manual Section: Professional Pro Edition -->
<section id="trainingManualContent" class="hidden">
  <div class="max-w-6xl mx-auto p-6">
    <!-- Header Section -->
    <div class="bg-gradient-to-r from-yellow-400 to-orange-500 rounded-xl p-6 mb-8 shadow-xl">
      <div class="flex items-center gap-4 mb-4">
        <span class="icon icon-book text-3xl text-white"></span>
        <h2 class="text-3xl font-extrabold text-white flex-1">Training Manual: Short Thesis Mastery</h2>
        <span class="bg-white bg-opacity-20 text-white px-4 py-2 rounded-full text-sm font-bold">Pro Guide</span>
      </div>
      <p class="text-white text-lg opacity-90">Step-by-step actionable lessons for professional trading mastery</p>
    </div>

    <!-- Phase Cards -->
    <div class="space-y-8">
      <!-- Phase 1: Foundation -->
      <div class="bg-gradient-to-br from-green-400 to-blue-500 rounded-xl p-6 shadow-xl">
        <div class="flex items-center gap-4 mb-6">
          <span class="icon icon-cubes text-3xl text-white"></span>
          <div class="flex-1">
            <h3 class="text-2xl font-bold text-white">Phase 1: The Foundation</h3>
            <p class="text-green-100">Build your mental armor and trading infrastructure</p>
          </div>
        </div>
        
        <div class="space-y-6">
          <!-- Lesson 1 -->
          <div class="bg-white bg-opacity-95 rounded-lg p-5">
            <h4 class="text-xl font-bold text-blue-900 mb-3 flex items-center gap-2">
              <span class="icon icon-brain"></span>
              Lesson 1: Foundation, Mindset, & Platform Choices
            </h4>
            <p class="text-blue-700 mb-4">This lesson builds your mental armor and understanding of the battlefield.</p>
            
            <div class="space-y-4">
              <div class="border-l-4 border-blue-500 pl-4">
                <h5 class="font-semibold text-blue-900 mb-2">Task 1: Internalize Deep Skepticism</h5>
                <div class="text-sm text-blue-800 space-y-1">
                  <p>‚Ä¢ Open www.x.com (formerly Twitter) and search for #memecoin or #1000xgem</p>
                  <p>‚Ä¢ Click the 'Latest' tab to see new posts; find a post with high engagement promoting a coin</p>
                  <p>‚Ä¢ Search for the coin's official website. In your journal, write three skeptical questions</p>
                  <div class="mt-2 p-3 bg-blue-50 rounded italic text-xs">
                    Example: "The website claims 'AI-powered decentralization.' Where is the technical whitepaper that explains this? Which AI models? How is it different from existing projects?"
                  </div>
                </div>
              </div>
              
              <div class="border-l-4 border-green-500 pl-4">
                <h5 class="font-semibold text-blue-900 mb-2">Task 2: Internalize Probabilistic Thinking</h5>
                <div class="text-sm text-blue-800 space-y-1">
                  <p>‚Ä¢ Read the "Probabilistic Thinking" resource from the syllabus</p>
                  <p>‚Ä¢ In your journal, complete: "Being a probabilistic trader means I accept that I can do everything right and still lose a trade... My goal is to be profitable over a large series of trades because my winners will outweigh my losers."</p>
                </div>
              </div>
              
              <div class="border-l-4 border-purple-500 pl-4">
                <h5 class="font-semibold text-blue-900 mb-2">Task 3: Learn to Formulate a Short Thesis</h5>
                <div class="text-sm text-blue-800 space-y-1">
                  <p>‚Ä¢ Go to www.coingecko.com. Find and add the '% ATH' column if needed</p>
                  <p>‚Ä¢ Click '% ATH' twice to sort by largest drops. Find a coin with recognizable name and 24h volume > $500,000</p>
                  <p>‚Ä¢ In your journal, write a one-sentence short thesis for a coin you find</p>
                  <div class="mt-2 p-3 bg-purple-50 rounded italic text-xs">
                    Example: "The short thesis for ExampleCoin (EXC) is that it was a failed hype cycle, confirmed by a 95% price collapse on declining volume."
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Lesson 2 -->
          <div class="bg-white bg-opacity-95 rounded-lg p-5">
            <h4 class="text-xl font-bold text-blue-900 mb-3 flex items-center gap-2">
              <span class="icon icon-target"></span>
              Lesson 2: Risk Management Mastery
            </h4>
            <p class="text-blue-700 mb-4">This is the science of survival. üë®‚Äçüî¨</p>
            
            <div class="border-l-4 border-red-500 pl-4">
              <h5 class="font-semibold text-blue-900 mb-2">Task: Master Position Sizing</h5>
              <div class="text-sm text-blue-800 space-y-1">
                <p>‚Ä¢ Open the BabyPips Position Size Calculator from the syllabus resources</p>
                <p>‚Ä¢ Scenario: $10,000 account, risk 1% on SOL short, enter at $150, stop-loss at $153</p>
                <p>‚Ä¢ In calculator: Account Currency USD, Balance 10000, Risk% 1, Stop Loss (pips) 3000 (since $3 = 3000 pips), Entry Price 150</p>
                <p>‚Ä¢ Calculator gives position size‚Äîamount of SOL to short to risk only $100</p>
                <p>‚Ä¢ Do the three sample trades from the syllabus in your journal</p>
              </div>
            </div>
          </div>

          <!-- Lesson 3 -->
          <div class="bg-white bg-opacity-95 rounded-lg p-5">
            <h4 class="text-xl font-bold text-blue-900 mb-3 flex items-center gap-2">
              <span class="icon icon-rocket"></span>
              Lesson 3: Platform Mastery & Tool Setup
            </h4>
            <p class="text-blue-700 mb-4">This is your pre-flight checklist. üöÄ</p>
            
            <div class="space-y-4">
              <div class="border-l-4 border-yellow-500 pl-4">
                <h5 class="font-semibold text-blue-900 mb-2">Task 1: Secure Your CeFi Account (MEXC)</h5>
                <div class="text-sm text-blue-800 space-y-1">
                  <p>‚Ä¢ Log into MEXC. Go to 'Security' under your profile</p>
                  <p>‚Ä¢ Setup MEXC/Google Authenticator and back up your security key</p>
                </div>
              </div>
              
              <div class="border-l-4 border-indigo-500 pl-4">
                <h5 class="font-semibold text-blue-900 mb-2">Task 2: Secure Your DeFi Wallet (Ledger + MetaMask)</h5>
                <div class="text-sm text-blue-800 space-y-1">
                  <p>‚Ä¢ Plug in Ledger, unlock, and open Ethereum app</p>
                  <p>‚Ä¢ Unlock MetaMask. Click the circle icon, select "Connect Hardware Wallet", choose Ledger</p>
                  <p>‚Ä¢ Select your Ledger ETH address in MetaMask; connect it to Hyperliquid</p>
                  <p class="text-red-600 font-semibold">‚Ä¢ Store your Ledger 24-word Recovery Phrase offline, never digitally</p>
                </div>
              </div>
              
              <div class="border-l-4 border-green-500 pl-4">
                <h5 class="font-semibold text-blue-900 mb-2">Task 3: Place a Test Order</h5>
                <div class="text-sm text-blue-800 space-y-1">
                  <p>‚Ä¢ On MEXC Futures, select BTC/USDT, use Limit order, price far from current, minimum amount, click Sell/Short, then Cancel</p>
                  <p>‚Ä¢ Repeat on Hyperliquid; approve via Ledger device when prompted</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Applied Module 1 -->
          <div class="bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg p-5 text-white">
            <h4 class="text-xl font-bold mb-3 flex items-center gap-2">
              <span class="icon icon-diamond"></span>
              Applied Learning Module 1: Anatomy of a World-Class Short
            </h4>
            <p class="mb-4 opacity-90">Goal: Synthesize foundation lessons to build a high-conviction trade plan.</p>
            
            <div class="space-y-3 text-sm">
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Target Acquisition:</strong> On CoinGecko, filter for 24h Volume > $2M, find Aetherium Prime ($AEP), down 82% from ATH, $5M volume.
              </div>
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Investigation:</strong>
                <ul class="mt-2 space-y-1 ml-4">
                  <li>‚Ä¢ <strong>Narrative & Sentiment:</strong> On LunarCrush, $AEP's social metrics have flatlined, sentiment is bearish</li>
                  <li>‚Ä¢ <strong>Tokenomics:</strong> On token.unlocks.app, 20% supply unlock in 2 weeks‚Äîa bearish catalyst</li>
                  <li>‚Ä¢ <strong>Insider Wallets:</strong> On Arkham Intelligence, a VC wallet is preparing to sell</li>
                </ul>
              </div>
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Synthesis:</strong> Write a thesis: "$AEP is a failed story coin, retail hype has died, and a 20% supply unlock for VCs is confirmed by on-chain prep to sell. High-probability short."
              </div>
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Tactical Plan:</strong> Chart: AEP/USDT on MEXC | Entry: Limit sell at $2.00 | Stop-Loss: $2.20 | Position Size: 1% of $10,000 = 500 AEP
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Phase 2: Short Thesis & Discovery -->
      <div class="bg-gradient-to-br from-yellow-400 to-orange-500 rounded-xl p-6 shadow-xl">
        <div class="flex items-center gap-4 mb-6">
          <span class="icon icon-search text-3xl text-white"></span>
          <div class="flex-1">
            <h3 class="text-2xl font-bold text-white">Phase 2: Short Thesis & Discovery</h3>
            <p class="text-yellow-100">Master market research and red flag identification</p>
          </div>
        </div>

        <div class="space-y-6">
          <!-- Lesson 4 -->
          <div class="bg-white bg-opacity-95 rounded-lg p-5">
            <h4 class="text-xl font-bold text-blue-900 mb-3 flex items-center gap-2">
              <span class="icon icon-search"></span>
              Lesson 4: Short Thesis Discovery & Analysis
            </h4>
            
            <div class="border-l-4 border-orange-500 pl-4">
              <h5 class="font-semibold text-blue-900 mb-2">Task: Discover a "Failed Hype Cycle" Candidate</h5>
              <div class="text-sm text-blue-800 space-y-1">
                <p>‚Ä¢ Go to www.dexscreener.com, click 'New Pairs'</p>
                <p>‚Ä¢ Sort by '1h' gainers. Look for tokens up 500%+ with age a few hours</p>
                <p>‚Ä¢ Bookmark and revisit in 24-48h. If price collapses, analyze in your journal</p>
              </div>
            </div>
          </div>

          <!-- Lesson 5 -->
          <div class="bg-white bg-opacity-95 rounded-lg p-5">
            <h4 class="text-xl font-bold text-blue-900 mb-3 flex items-center gap-2">
              <span class="icon icon-fire"></span>
              Lesson 5: Red Flags & Scam Spotting
            </h4>
            
            <div class="border-l-4 border-red-500 pl-4">
              <h5 class="font-semibold text-blue-900 mb-2">Task: Spot a "Rug Pull" Red Flag</h5>
              <div class="text-sm text-blue-800 space-y-1">
                <p>‚Ä¢ Find a new token on Dexscreener</p>
                <p>‚Ä¢ Look for 'Liquidity is Locked'. Red box warnings about unlocked liquidity or high holder concentration are major red flags</p>
                <p>‚Ä¢ Screenshot and journal the red flag</p>
              </div>
            </div>
          </div>

          <!-- Applied Module 2 -->
          <div class="bg-gradient-to-r from-red-500 to-pink-600 rounded-lg p-5 text-white">
            <h4 class="text-xl font-bold mb-3 flex items-center gap-2">
              <span class="icon icon-fire"></span>
              Applied Learning Module 2: A Tale of Two Red Flags
            </h4>
            <div class="space-y-3 text-sm">
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Case 1:</strong> The "Honeypot" Scam ‚Äî No SELL transactions, only BUYs, Dexscreener flags. "Too good to be true" = trap.
              </div>
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Case 2:</strong> The "Slow Rug" ‚Äî DeFi project down 95%, abandoned social, devs slowly cashing out. Journal these findings.
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Phase 3: Execution & Journaling -->
      <div class="bg-gradient-to-br from-pink-400 to-red-500 rounded-xl p-6 shadow-xl">
        <div class="flex items-center gap-4 mb-6">
          <span class="icon icon-pen text-3xl text-white"></span>
          <div class="flex-1">
            <h3 class="text-2xl font-bold text-white">Phase 3: Execution & Journaling</h3>
            <p class="text-pink-100">Execute trades with precision and document everything</p>
          </div>
        </div>

        <div class="space-y-6">
          <!-- Lesson 6 -->
          <div class="bg-white bg-opacity-95 rounded-lg p-5">
            <h4 class="text-xl font-bold text-blue-900 mb-3 flex items-center gap-2">
              <span class="icon icon-target"></span>
              Lesson 6: Short Entry Execution
            </h4>
            
            <div class="border-l-4 border-pink-500 pl-4">
              <h5 class="font-semibold text-blue-900 mb-2">Task: Identify an Optimal Entry Point</h5>
              <div class="text-sm text-blue-800 space-y-1">
                <p>‚Ä¢ On TradingView, load a pump-and-dump token's 1H chart</p>
                <p>‚Ä¢ Mark horizontal support where price bounced up</p>
                <p>‚Ä¢ Find where price crashed below that line (broken support)</p>
                <p>‚Ä¢ Optimal short entry is often a retest of the broken support from below</p>
              </div>
            </div>
          </div>

          <!-- Lesson 7 -->
          <div class="bg-white bg-opacity-95 rounded-lg p-5">
            <h4 class="text-xl font-bold text-blue-900 mb-3 flex items-center gap-2">
              <span class="icon icon-book"></span>
              Lesson 7: Journaling for Improvement
            </h4>
            <p class="text-blue-700 mb-4">This is the most important habit of any professional trader.</p>
            
            <div class="border-l-4 border-blue-500 pl-4">
              <div class="text-sm text-blue-800 space-y-1">
                <p>‚Ä¢ In a spreadsheet, create columns: Date, Asset, Thesis, Entry, SL, TP, Position Size, Outcome (W/L), P&L ($), Emotion/Psychology, Mistakes/Lessons</p>
                <p>‚Ä¢ After every trade, fill out the journal‚Äîbe honest, especially about emotions and lessons</p>
              </div>
            </div>
          </div>

          <!-- Applied Module 3 -->
          <div class="bg-gradient-to-r from-green-500 to-blue-600 rounded-lg p-5 text-white">
            <h4 class="text-xl font-bold mb-3 flex items-center gap-2">
              <span class="icon icon-check"></span>
              Applied Learning Module 3: From Plan to Action
            </h4>
            <div class="space-y-3 text-sm">
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Scenario:</strong> $AEP trade plan is active. Price rallies to $2.00.
              </div>
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Execution:</strong> On MEXC, Limit Sell 500 AEP at $2.00, TP $1.20, SL $2.20.
              </div>
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Outcome:</strong> TP hit at $1.20, +$400 profit.
              </div>
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Journaling:</strong> Asset: $AEP, Thesis: "Failed hype + VC unlock", Entry: $2.00, SL: $2.20, TP: $1.20, Outcome: Win, P&L: $400, Emotion: "Anxious, but trusted plan", Lesson: "Research edge is key."
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Phase 4: Advanced Scenarios & Psychology -->
      <div class="bg-gradient-to-br from-purple-400 to-pink-500 rounded-xl p-6 shadow-xl">
        <div class="flex items-center gap-4 mb-6">
          <span class="icon icon-brain text-3xl text-white"></span>
          <div class="flex-1">
            <h3 class="text-2xl font-bold text-white">Phase 4: Advanced Scenarios & Psychology</h3>
            <p class="text-purple-100">Master your mind and control your emotions</p>
          </div>
        </div>

        <div class="space-y-6">
          <!-- Lesson 8 -->
          <div class="bg-white bg-opacity-95 rounded-lg p-5">
            <h4 class="text-xl font-bold text-blue-900 mb-3 flex items-center gap-2">
              <span class="icon icon-brain"></span>
              Lesson 8: Trader Psychology & FOMO
            </h4>
            
            <div class="border-l-4 border-purple-500 pl-4">
              <h5 class="font-semibold text-blue-900 mb-2">Task: Document FOMO</h5>
              <div class="text-sm text-blue-800">
                <p>When you feel the urge to chase a pump, pause and journal the feeling. Recognizing FOMO is the first step to control.</p>
              </div>
            </div>
          </div>

          <!-- Lesson 9 -->
          <div class="bg-white bg-opacity-95 rounded-lg p-5">
            <h4 class="text-xl font-bold text-blue-900 mb-3 flex items-center gap-2">
              <span class="icon icon-fire"></span>
              Lesson 9: Dealing with Losses & Tilt
            </h4>
            
            <div class="border-l-4 border-red-500 pl-4">
              <h5 class="font-semibold text-blue-900 mb-2">Task: Create a "Circuit Breaker"</h5>
              <div class="text-sm text-blue-800">
                <p><strong>Example Rule:</strong> "If I lose 3 trades in a row, OR my account is down 2% in a day, I will shut down and not trade for 24h. No exceptions."</p>
              </div>
            </div>
          </div>

          <!-- Applied Module 4 -->
          <div class="bg-gradient-to-r from-red-500 to-purple-600 rounded-lg p-5 text-white">
            <h4 class="text-xl font-bold mb-3 flex items-center gap-2">
              <span class="icon icon-fire"></span>
              Applied Learning Module 4: The Losing Trade
            </h4>
            <div class="space-y-3 text-sm">
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Scenario:</strong> Short thesis on $BETA, but surprise positive news hits. Stop-loss triggered, lose 1%.
              </div>
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Psych Response:</strong> Initial anger, urge to revenge trade.
              </div>
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Professional Process:</strong> Recognize emotion ‚Üí execute "circuit breaker" ‚Üí log out ‚Üí journal trade and feelings.
              </div>
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Lesson:</strong> Losses happen outside your control. Journaling turns emotion into lesson and reinforces discipline.
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Phase 5: Mastery & Peer Review -->
      <div class="bg-gradient-to-br from-yellow-400 to-green-400 rounded-xl p-6 shadow-xl">
        <div class="flex items-center gap-4 mb-6">
          <span class="icon icon-certificate text-3xl text-white"></span>
          <div class="flex-1">
            <h3 class="text-2xl font-bold text-white">Phase 5: Mastery & Peer Review</h3>
            <p class="text-yellow-100">Achieve certification and join the professional community</p>
          </div>
        </div>

        <div class="space-y-6">
          <!-- Lesson 10 -->
          <div class="bg-white bg-opacity-95 rounded-lg p-5">
            <h4 class="text-xl font-bold text-blue-900 mb-3 flex items-center gap-2">
              <span class="icon icon-star"></span>
              Lesson 10: Peer Review & Community
            </h4>
            
            <div class="border-l-4 border-green-500 pl-4">
              <div class="text-sm text-blue-800 space-y-1">
                <p>‚Ä¢ Go to TradingView > Community or Ideas tab</p>
                <p>‚Ä¢ Find a published short idea for crypto. Read and critique in your journal</p>
                <div class="mt-2 p-3 bg-green-50 rounded italic text-xs">
                  Example: "Good bearish pattern, but thesis lacks tokenomics. Stop-loss too wide, poor R:R."
                </div>
              </div>
            </div>
          </div>

          <!-- Lesson 11 -->
          <div class="bg-white bg-opacity-95 rounded-lg p-5">
            <h4 class="text-xl font-bold text-blue-900 mb-3 flex items-center gap-2">
              <span class="icon icon-certificate"></span>
              Lesson 11: Final Project & Certification
            </h4>
            
            <div class="border-l-4 border-yellow-500 pl-4">
              <h5 class="font-semibold text-blue-900 mb-2">Task: Achieve Professional Certification</h5>
              <div class="text-sm text-blue-800">
                <p>Paper trade for 1 month. Log at least 10-15 trades with full journal entries. Review best/worst trades and write your final report as per syllabus. This is your certification for live trading.</p>
              </div>
            </div>
          </div>

          <!-- Applied Module 5 -->
          <div class="bg-gradient-to-r from-green-500 to-yellow-500 rounded-lg p-5 text-white">
            <h4 class="text-xl font-bold mb-3 flex items-center gap-2">
              <span class="icon icon-trophy"></span>
              Applied Learning Module 5: From Trader to Analyst
            </h4>
            <div class="space-y-3 text-sm">
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Scenario:</strong> End of certification month, 12 paper trades, 7 winners, 5 losers, net P&L positive.
              </div>
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Report:</strong> Analyze one winning, one losing trade. Focus on execution and process, not outcome.
              </div>
              <div class="bg-white bg-opacity-20 rounded p-3">
                <strong>Reflection:</strong> "My biggest lesson: My job is to be a risk manager, not a predictor. Profits came from discipline and cutting losses. I am now ready for live trading with a professional process."
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="mt-12 bg-blue-900 rounded-xl p-6 shadow-lg text-center">
      <div class="flex items-center justify-center gap-3 mb-4">
        <span class="icon icon-rocket text-2xl text-yellow-300"></span>
        <h3 class="text-xl font-bold text-white">Your Trading Edge</h3>
      </div>
      <p class="text-blue-100 text-lg mb-2">This manual is your edge. Revisit before every big trade.</p>
      <div class="flex items-center justify-center gap-2 text-yellow-300">
        <span class="icon icon-diamond"></span>
        <span class="text-sm font-semibold">Pro Edition ‚Ä¢ Advanced Trading Mastery</span>
        <span class="icon icon-diamond"></span>
      </div>
    </div>
  </div>
  <!-- FontAwesome for icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
  <style>
    .manual-section ul { margin-bottom: 0; }
    .manual-section h3 { letter-spacing: 0.01em; }
    .manual-section { font-family: 'Montserrat', system-ui, sans-serif; }
    .manual-section h4 { margin-top: 0.75rem; }
    .manual-section ol, .manual-section ul { margin-top: 0.3rem; }
  </style>
</section>
<!-- Trading Journal & Syllabus Pro: Now with Dashboard Sync -->
<section id="journalContent" class="hidden">
  <div class="manual-section p-8 rounded-xl shadow mb-8 mx-auto" style="max-width:100rem;">

    <!-- HEADER + BADGES/PROGRESS -->
    <div class="flex flex-col md:flex-row items-center gap-8">
      <div class="md:w-2/3">
        <h2 class="text-3xl font-extrabold mb-3 text-blue-200">Trading Journal</h2>
        <ul class="mt-4 list-disc ml-8 text-blue-50 text-base space-y-1">
          <li>Log every trade with full details, outcome, emotions, and lessons learned.</li>
          <li>Phase progress and badges unlock as you journal. See your stats, compete on the leaderboard!</li>
        </ul>
        <div class="mt-6 bg-blue-700/80 border-l-4 border-blue-300 px-4 py-3 rounded">
          <b class="text-yellow-100">Tip:</b>
          <span class="text-blue-100">
            Consistent journaling is the #1 habit of professional traders. Use this as your edge!
          </span>
        </div>
      </div>
      <div class="md:w-1/3 flex flex-col items-center gap-3">
        <div class="w-full mb-3">
          <div class="flex items-center gap-2 mb-1">
            <span class="text-yellow-100 font-bold text-base"><i class="fas fa-chart-line"></i> Progress</span>
            <span id="journal-progress-label" class="ml-auto text-blue-200 text-xs"></span>
          </div>
          <div class="w-full bg-blue-900/60 rounded-full h-6 shadow relative">
            <div id="journal-progress-bar" class="bg-gradient-to-r from-yellow-400 to-green-300 h-6 rounded-full transition-all" style="width:0%"></div>
          </div>
        </div>
        <div class="flex flex-wrap gap-2 justify-center mt-1" id="journal-badges"></div>
      </div>
    </div>

    <!-- PHASES & PHASE-STATS -->
    <div class="mt-8 mb-8 p-6 rounded-xl bg-[#21243b] border border-blue-900 shadow-lg" style="max-width:64rem;margin:auto;">
      <h3 class="text-xl font-bold text-yellow-100 flex items-center gap-2 mb-3"><i class="fas fa-graduation-cap"></i> Syllabus Phase Progress</h3>
      <div id="syllabus-phase-list" class="flex flex-col gap-4"></div>
      <div class="mt-6">
        <h4 class="text-lg text-blue-100 font-bold mb-2 flex items-center gap-2"><i class="fas fa-chart-pie"></i> Phase-Specific Journal Stats</h4>
        <div id="phase-journal-stats" class="flex flex-wrap gap-4"></div>
      </div>
    </div>

    <!-- LEADERBOARD -->
    <div class="mt-2 mb-8 p-6 rounded-xl bg-[#181e2a] border border-blue-900 shadow-lg" style="max-width:64rem;margin:auto;">
      <h3 class="text-lg font-bold text-yellow-100 flex items-center gap-2 mb-3"><i class="fas fa-trophy"></i> Leaderboard: Top Journalers (Device Only)</h3>
      <div id="journal-leaderboard" class="flex flex-col gap-1"></div>
      <div class="text-xs text-blue-100 mt-2">* This leaderboard is stored only in your browser (local device/sandbox).</div>
    </div>

    <!-- JOURNAL ENTRY FORM -->
    <div class="mt-12 mb-6 bg-[#232946] p-6 rounded-lg border border-blue-900 shadow-2xl mx-auto"
         style="max-width:80rem;min-width:340px;overflow-x:auto;">
      <h3 class="text-xl font-bold text-blue-100 mb-4">New Trade Entry</h3>
      <form id="journalForm" class="grid grid-cols-1 md:grid-cols-4 gap-4 journal-form" autocomplete="off">
        <div>
          <label class="block mb-1" for="journal-date">Date</label>
          <input type="date" id="journal-date" required class="w-full" />
        </div>
        <div>
          <label class="block mb-1" for="journal-asset">Asset</label>
          <input type="text" id="journal-asset" placeholder="e.g. BTC/USDT" required class="w-full" />
        </div>
        <div>
          <label class="block mb-1" for="journal-direction">Direction</label>
          <select id="journal-direction" required class="w-full">
            <option value="Long">Long</option>
            <option value="Short">Short</option>
          </select>
        </div>
        <div>
          <label class="block mb-1" for="journal-phase">Phase</label>
          <select id="journal-phase" required class="w-full">
            <option value="Foundation">Foundation</option>
            <option value="Short Thesis & Discovery">Short Thesis & Discovery</option>
            <option value="Execution & Journaling">Execution & Journaling</option>
            <option value="Advanced Scenarios & Psychology">Advanced Scenarios & Psychology</option>
            <option value="Mastery & Peer Review">Mastery & Peer Review</option>
          </select>
        </div>
        <div>
          <label class="block mb-1" for="journal-thesis">Trade Thesis</label>
          <input type="text" id="journal-thesis" placeholder="Brief reason" required class="w-full" />
        </div>
        <div>
          <label class="block mb-1" for="journal-entry">Entry Price</label>
          <input type="number" step="any" id="journal-entry" required class="w-full" min="0.00000001" />
        </div>
        <div>
          <label class="block mb-1" for="journal-exit">Exit Price</label>
          <input type="number" step="any" id="journal-exit" required class="w-full" min="0.00000001" />
        </div>
        <div>
          <label class="block mb-1" for="journal-sl">Stop Loss</label>
          <input type="number" step="any" id="journal-sl" class="w-full" min="0" />
        </div>
        <div>
          <label class="block mb-1" for="journal-tp">Take Profit</label>
          <input type="number" step="any" id="journal-tp" class="w-full" min="0" />
        </div>
        <div>
          <label class="block mb-1" for="journal-size">Position Size</label>
          <input type="number" step="any" id="journal-size" required class="w-full" min="0.00000001" />
        </div>
        <div>
  <label class="block mb-1" for="journal-outcome">Outcome</label>
  <select id="journal-outcome" required class="w-full">
    <option value="Win">Win</option>
    <option value="Loss">Loss</option>
    <option value="Breakeven">Breakeven</option>
  </select>
</div>
<div>
  <label class="block mb-1" for="journal-pnl">P&amp;L ($)</label>
  <input type="number" step="any" id="journal-pnl" readonly tabindex="-1" class="w-full journal-pnl-readonly" />
</div>
        <div>
          <label class="block mb-1" for="journal-emotion">Emotion/Psychology</label>
          <input type="text" id="journal-emotion" placeholder="e.g. FOMO, confident..." class="w-full" />
        </div>
        <div class="md:col-span-4">
          <label class="block mb-1" for="journal-mistakes">Mistakes/Lessons Learned</label>
          <textarea id="journal-mistakes" rows="2" class="w-full"></textarea>
        </div>
        <div class="md:col-span-4 flex gap-2 mt-2 flex-wrap justify-end min-w-[320px]">
          <button type="submit" class="bg-blue-700 hover:bg-blue-800 text-white font-bold px-6 py-2 rounded shadow transition">Add Entry</button>
          <button type="button" id="journalClearBtn" class="bg-red-600 hover:bg-red-700 text-white font-bold px-6 py-2 rounded shadow transition ml-2" title="Clear all journal entries">Clear All</button>
          <button type="button" id="journalExportBtn" class="bg-yellow-500 hover:bg-yellow-600 text-blue-900 font-bold px-6 py-2 rounded shadow transition ml-2" title="Export journal to CSV">Export CSV</button>
        </div>
        <div id="journal-message" class="col-span-4 mt-2 text-green-300 font-semibold"></div>
      </form>
    </div>
<!-- JOURNAL TABLE & FILTERS -->
<div class="mb-6 flex flex-col md:flex-row gap-8 items-center">
  <div class="w-full md:w-2/3">
    <div class="bg-blue-900/80 border-l-4 border-blue-400 px-4 py-3 rounded text-blue-100 font-mono font-semibold mb-2">
      <span id="journal-progress">No entries yet.</span>
    </div>
  </div>
  <div class="w-full md:w-1/3">
    <div class="flex gap-2 items-center justify-end">
      <label for="journal-filter-phase" class="text-blue-100">Phase:</label>
      <select id="journal-filter-phase" class="px-2 py-1 rounded">
        <option value="All">All</option>
        <option value="Foundation">Foundation</option>
        <option value="Short Thesis & Discovery">Short Thesis & Discovery</option>
        <option value="Execution & Journaling">Execution & Journaling</option>
        <option value="Advanced Scenarios & Psychology">Advanced Scenarios & Psychology</option>
        <option value="Mastery & Peer Review">Mastery & Peer Review</option>
      </select>
      <label for="journal-filter-outcome" class="text-blue-100 ml-2">Filter:</label>
      <select id="journal-filter-outcome" class="px-2 py-1 rounded">
        <option value="All">All</option>
        <option value="Win">Wins</option>
        <option value="Loss">Losses</option>
        <option value="Breakeven">Breakeven</option>
      </select>
    </div>
  </div>
</div>
<!-- PASTE THE TABLE BLOCK RIGHT HERE! -->
<div class="overflow-x-auto mt-3">
  <table class="min-w-full bg-[#181e2a] rounded-lg overflow-x-auto text-blue-100">
    <thead>
      <tr>
        <th>Date</th>
        <th>Asset</th>
        <th>Direction</th>
        <th>Phase</th>
        <th>Thesis</th>
        <th>Entry</th>
        <th>Exit</th>
        <th>SL</th>
        <th>TP</th>
        <th>Size</th>
        <th>Outcome</th>
        <th>PNL</th>
        <th>Emotion</th>
        <th>Mistakes</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="journal-table-body"></tbody>
  </table>
</div>
<style>
  
/* Force wrap in Thesis, Emotion, Mistakes, Actions columns */
#journal-table-body td.wrap-long {
  white-space: pre-wrap !important;
  word-break: break-word !important;
  overflow-wrap: break-word !important;
  max-width: 350px;
  writing-mode: horizontal-tb !important;
  vertical-align: top !important;
}
</style>
</section>
 <!-- Dashboard -->
<!-- DASHBOARD SECTION: Clean, Synced, Standalone, Paste-Ready -->
<section id="dashboardContent" class="hidden">
  <div class="dashboard-section p-8 rounded-xl shadow mb-8 mx-auto max-w-7xl">
    <h2 class="text-3xl font-extrabold mb-3 text-blue-200">Dashboard Overview</h2>
    <ul class="mt-4 list-disc ml-8 text-blue-50 text-base space-y-1">
      <li>Visualize your trading performance, risk, and consistency.</li>
      <li>Interactive filters and analytics‚Äîsee stats by date, asset, or direction.</li>
      <li>Charts are large and styled for professional clarity.</li>
    </ul>
    <div class="mt-6 bg-blue-700/80 border-l-4 border-blue-300 px-4 py-3 rounded">
      <b class="text-yellow-100">Tip:</b>
      <span class="text-blue-100">
        Use the Dashboard to spot your edge, weaknesses, and review after every session!
      </span>
    </div>

    <!-- FILTERS -->
    <div class="mt-10 mb-8 flex flex-wrap gap-4 items-center bg-blue-800/70 rounded-lg p-4">
      <label class="text-blue-100 font-semibold" for="db-filter-asset">Asset:</label>
      <select id="db-filter-asset" class="px-2 py-1 rounded text-base bg-blue-900 text-blue-100 border border-blue-700"></select>
      <label class="text-blue-100 font-semibold" for="db-filter-direction">Direction:</label>
      <select id="db-filter-direction" class="px-2 py-1 rounded text-base bg-blue-900 text-blue-100 border border-blue-700">
        <option value="">All</option>
        <option value="Long">Long</option>
        <option value="Short">Short</option>
      </select>
      <label class="text-blue-100 font-semibold" for="db-filter-datefrom">From:</label>
      <input type="date" id="db-filter-datefrom" class="px-2 py-1 rounded text-base bg-blue-900 text-blue-100 border border-blue-700"/>
      <label class="text-blue-100 font-semibold" for="db-filter-dateto">To:</label>
      <input type="date" id="db-filter-dateto" class="px-2 py-1 rounded text-base bg-blue-900 text-blue-100 border border-blue-700"/>
      <button id="db-filter-reset" class="ml-4 px-4 py-1 bg-blue-700 hover:bg-blue-800 text-blue-100 rounded font-bold text-sm transition">Reset</button>
    </div>

    <!-- Dashboard Stats -->
    <div class="mt-6 grid grid-cols-1 md:grid-cols-4 gap-8">
      <div class="stat-card bg-blue-800/80 text-blue-100 rounded-lg p-6 flex flex-col items-center shadow">
        <div class="text-4xl font-extrabold" id="db-total-trades">0</div>
        <div class="mt-2 uppercase text-blue-300 tracking-wide font-bold text-xs">Total Trades</div>
      </div>
      <div class="stat-card bg-blue-800/80 text-blue-100 rounded-lg p-6 flex flex-col items-center shadow">
        <div class="text-4xl font-extrabold text-green-300" id="db-win-rate">0%</div>
        <div class="mt-2 uppercase text-blue-300 tracking-wide font-bold text-xs">Win Rate</div>
      </div>
      <div class="stat-card bg-blue-800/80 text-blue-100 rounded-lg p-6 flex flex-col items-center shadow">
        <div class="text-4xl font-extrabold text-yellow-300" id="db-pnl">0</div>
        <div class="mt-2 uppercase text-blue-300 tracking-wide font-bold text-xs">Net P&amp;L ($)</div>
      </div>
      <div class="stat-card bg-blue-800/80 text-blue-100 rounded-lg p-6 flex flex-col items-center shadow">
        <div class="text-4xl font-extrabold text-pink-300" id="db-max-drawdown">0</div>
        <div class="mt-2 uppercase text-blue-300 tracking-wide font-bold text-xs">Max Drawdown</div>
      </div>
    </div>

    <!-- Dashboard Charts -->
    <div class="mt-12 grid grid-cols-1 xl:grid-cols-2 gap-10">
      <div class="bg-[#232946] rounded-lg p-6 shadow-lg flex flex-col min-h-[420px]">
        <div class="text-lg font-bold text-blue-100 mb-3">Equity Curve</div>
        <canvas id="db-equity-curve" height="300"></canvas>
      </div>
      <div class="bg-[#232946] rounded-lg p-6 shadow-lg flex flex-col min-h-[420px]">
        <div class="text-lg font-bold text-blue-100 mb-3">Trades by Outcome</div>
        <canvas id="db-pie-outcome" height="300"></canvas>
      </div>
      <div class="bg-[#232946] rounded-lg p-6 shadow-lg flex flex-col min-h-[420px]">
        <div class="text-lg font-bold text-blue-100 mb-3">P&amp;L by Asset</div>
        <canvas id="db-bar-asset" height="300"></canvas>
      </div>
      <div class="bg-[#232946] rounded-lg p-6 shadow-lg flex flex-col min-h-[420px]">
        <div class="text-lg font-bold text-blue-100 mb-3">Long vs Short Win Rate</div>
        <canvas id="db-bar-longshort" height="300"></canvas>
      </div>
      <div class="bg-[#232946] rounded-lg p-6 shadow-lg flex flex-col min-h-[420px] xl:col-span-2">
        <div class="text-lg font-bold text-blue-100 mb-3">Monthly Performance</div>
        <canvas id="db-bar-month" height="300"></canvas>
      </div>
      <div class="bg-[#232946] rounded-lg p-6 shadow-lg flex flex-col min-h-[420px] xl:col-span-2">
        <div class="text-lg font-bold text-blue-100 mb-3">Largest Wins &amp; Losses</div>
        <canvas id="db-bar-bigtrades" height="300"></canvas>
      </div>
    </div>

    <!-- Dashboard Table: Top Mistakes & Lessons -->
    <div class="mt-12 bg-blue-800/80 rounded-lg shadow-lg p-6">
      <div class="text-lg font-bold text-yellow-200 mb-3">Most Frequent Mistakes &amp; Lessons</div>
      <ul id="db-mistakes-list" class="list-disc pl-8 text-blue-100 text-base space-y-2"></ul>
    </div>
  </div>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
  <style>
    .dashboard-section {
      font-family: 'Montserrat', system-ui, sans-serif;
    }
    .stat-card {
      min-width: 0;
      min-height: 120px;
      background: linear-gradient(120deg, #232946 60%, #2e3866 100%);
      border: 1px solid #2e3866;
    }
    canvas {
      background: transparent;
      width: 100% !important;
      height: 320px !important;
      max-width: 100%;
      display: block;
    }
    #db-mistakes-list li {
      border-left: 4px solid #facc15;
      padding-left: 0.75rem;
      background: #28304a44;
      border-radius: 0.25rem;
      margin-bottom: 0.5rem;
    }
    .min-h-\[420px\] { min-height: 420px; }
    @media (max-width: 900px) {
      .dashboard-section { padding: 1rem !important; }
      .stat-card { padding: 1.5rem 0.7rem; }
      .min-h-\[420px\] { min-height: 300px; }
      canvas { height: 200px !important; }
    }
    @media (max-width: 600px) {
      .stat-card { min-height: 80px; }
      .min-h-\[420px\] { min-height: 180px; }
      canvas { height: 120px !important; }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script>
    // --- ENSURE JOURNAL_KEY IS GLOBAL ---
    window.JOURNAL_KEY = window.JOURNAL_KEY || "griffinsrise_journal_v1";
    function getJournal() {
      const data = localStorage.getItem(window.JOURNAL_KEY);
      return data ? JSON.parse(data) : [];
    }
    function safeNum(n) { n = Number(n); return isNaN(n) ? 0 : n; }
    function unique(arr) { return [...new Set(arr.filter(Boolean))]; }

    // --- FILTERS ---
    function getDashboardFilters() {
      return {
        asset: document.getElementById("db-filter-asset").value || "",
        direction: document.getElementById("db-filter-direction").value || "",
        dateFrom: document.getElementById("db-filter-datefrom").value || "",
        dateTo: document.getElementById("db-filter-dateto").value || ""
      };
    }
    function filterJournal(journal, filters) {
      return journal.filter(e => {
        if(filters.asset && e.asset !== filters.asset) return false;
        if(filters.direction && e.direction !== filters.direction) return false;
        if(filters.dateFrom && e.date && e.date < filters.dateFrom) return false;
        if(filters.dateTo && e.date && e.date > filters.dateTo) return false;
        return true;
      });
    }

    // --- STATS/CHARTS ---
    function calcStats(journal) {
      let stats = {
        total: 0,
        wins: 0,
        losses: 0,
        breakevens: 0,
        winRate: 0,
        pnl: 0,
        maxDrawdown: 0,
        equity: [],
        pie: {Win:0, Loss:0, Breakeven:0},
        byAsset: {},
        byDirection: {Long: {win:0, total:0}, Short:{win:0, total:0}},
        byMonth: {},
        bigWins: [],
        bigLosses: [],
        mistakes: [],
      };
      let eq = 0, maxPeak = 0, maxDD = 0, dd = 0;
      journal = journal.slice().reverse();  // oldest to newest for equity
      journal.forEach(e => {
        let p = safeNum(e.pnl);
        eq += p;
        stats.equity.push(eq);
        if(eq > maxPeak) maxPeak = eq;
        dd = maxPeak - eq;
        if(dd > maxDD) maxDD = dd;
        stats.total++;
        if(e.outcome === "Win") stats.wins++;
        else if(e.outcome === "Loss") stats.losses++;
        else if(e.outcome === "Breakeven") stats.breakevens++;
        stats.pie[e.outcome] = (stats.pie[e.outcome]||0)+1;
        stats.byAsset[e.asset] = (stats.byAsset[e.asset]||0) + p;
        if(e.direction === "Long" || e.direction === "Short") {
          stats.byDirection[e.direction].total++;
          if(e.outcome === "Win") stats.byDirection[e.direction].win++;
        }
        if(e.date && /^[0-9]{4}-[0-9]{2}/.test(e.date)) {
          const ym = e.date.slice(0,7);
          stats.byMonth[ym] = (stats.byMonth[ym]||0) + p;
        }
        if(typeof p === 'number') {
          if(p > 0) stats.bigWins.push({date:e.date||"", pnl:p, asset:e.asset||""});
          else if(p < 0) stats.bigLosses.push({date:e.date||"", pnl:p, asset:e.asset||""});
        }
        if(e.mistakes) stats.mistakes.push(e.mistakes.trim());
      });
      stats.winRate = stats.total ? (stats.wins / stats.total * 100).toFixed(1) : 0;
      stats.pnl = eq;
      stats.maxDrawdown = maxDD;
      stats.bigWins = stats.bigWins.sort((a,b)=>b.pnl-a.pnl).slice(0,5);
      stats.bigLosses = stats.bigLosses.sort((a,b)=>a.pnl-b.pnl).slice(0,5);
      return stats;
    }

    // --- RENDER DASHBOARD ---
    function renderDashboard() {
      const allJournal = getJournal();
      // Populate asset dropdown
      const assetSel = document.getElementById("db-filter-asset");
      const currentAsset = assetSel.value;
      const assets = unique(allJournal.map(e=>e.asset));
      assetSel.innerHTML = '<option value="">All</option>' + assets.map(a=>`<option>${a}</option>`).join('');
      assetSel.value = currentAsset; // Retain selection

      // Apply filters
      const filters = getDashboardFilters();
      const journal = filterJournal(allJournal, filters);
      const stats = calcStats(journal);

      // Stats
      document.getElementById("db-total-trades").textContent = stats.total;
      document.getElementById("db-win-rate").textContent = stats.winRate + "%";
      document.getElementById("db-pnl").textContent = (stats.pnl >= 0 ? "+" : "") + stats.pnl.toFixed(2);
      document.getElementById("db-max-drawdown").textContent = "-" + stats.maxDrawdown.toFixed(2);

      // --- CHART COLORS ---
      const chartColors = {
        blue: "#38bdf8",
        green: "#22d3ee",
        lightGreen: "#4ade80",
        yellow: "#eab308",
        orange: "#f59e42",
        red: "#ef4444",
        pink: "#e879f9",
        purple: "#a78bfa",
        bg: "rgba(56,189,248,0.12)",
        gray: "#64748b",
        dark: "#232946"
      };

      // --- Equity Curve ---
      if(window.dbEqChart) window.dbEqChart.destroy();
      const eqLabels = journal.map((e,i)=>e.date||("T"+(i+1)));
      window.dbEqChart = new Chart(document.getElementById("db-equity-curve"), {
        type: 'line',
        data: {
          labels: eqLabels,
          datasets: [{
            label: "Equity",
            data: stats.equity,
            fill: true,
            borderColor: chartColors.blue,
            backgroundColor: chartColors.bg,
            pointRadius: 3,
            pointBackgroundColor: chartColors.yellow,
            tension: 0.22
          }]
        },
        options: {
          plugins: {legend: {display:false}, tooltip: {mode:'index', intersect:false, titleColor:'#fff', bodyColor:'#fff'}},
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: { display: true, ticks:{color:chartColors.gray}, grid:{color:'#28304a'}, title:{display:true,text:'Trade'} },
            y: { beginAtZero: true, grid: {color:'#28304a'}, ticks:{color:chartColors.gray} }
          }
        }
      });

      // --- Pie Chart by Outcome ---
      if(window.dbPieChart) window.dbPieChart.destroy();
      window.dbPieChart = new Chart(document.getElementById("db-pie-outcome"), {
        type: 'doughnut',
        data: {
          labels: ["Win", "Loss", "Breakeven"],
          datasets: [{
            data: [stats.pie.Win||0, stats.pie.Loss||0, stats.pie.Breakeven||0],
            backgroundColor: [chartColors.lightGreen, chartColors.red, chartColors.yellow],
            borderColor: chartColors.dark,
            borderWidth: 2
          }]
        },
        options: {
          plugins: { 
            legend: {labels:{color:chartColors.gray, font:{weight:'bold'}}},
            tooltip: {callbacks:{
              label: ctx => ctx.label+": "+ctx.parsed+" ("+((ctx.parsed/stats.total*100)||0).toFixed(1)+"%)"
            }},
          },
          cutout: "60%",
          responsive: true,
          maintainAspectRatio: false,
        }
      });

      // --- Bar: P&L by Asset ---
      if(window.dbAssetChart) window.dbAssetChart.destroy();
      const assetLabels = Object.keys(stats.byAsset);
      const assetData = assetLabels.map(k=>stats.byAsset[k]);
      window.dbAssetChart = new Chart(document.getElementById("db-bar-asset"), {
        type: 'bar',
        data: {
          labels: assetLabels,
          datasets: [{
            label: "Net P&L",
            data: assetData,
            backgroundColor: assetData.map(v=>v>=0?chartColors.green:chartColors.red)
          }]
        },
        options: {
          plugins: { legend: {display:false} },
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: { ticks:{color:chartColors.gray}, grid:{color:'#28304a'} },
            y: { beginAtZero:true, ticks:{color:chartColors.gray}, grid:{color:'#28304a'} }
          }
        }
      });

      // --- Bar: Long vs Short Win Rate ---
      if(window.dbLongShortChart) window.dbLongShortChart.destroy();
      const dirs = ["Long","Short"];
      const wr = dirs.map(d=>stats.byDirection[d].total?stats.byDirection[d].win/stats.byDirection[d].total*100:0);
      window.dbLongShortChart = new Chart(document.getElementById("db-bar-longshort"), {
        type: 'bar',
        data: {
          labels: dirs,
          datasets: [{
            label: "Win Rate (%)",
            data: wr,
            backgroundColor: [chartColors.blue,chartColors.pink]
          }]
        },
        options: {
          plugins: { legend: {display:false} },
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: { ticks:{color:chartColors.gray}, grid:{color:'#28304a'} },
            y: { beginAtZero:true, max:100, ticks:{color:chartColors.gray}, grid:{color:'#28304a'} }
          }
        }
      });

      // --- Monthly Performance Bar ---
      if(window.dbMonthChart) window.dbMonthChart.destroy();
      const months = Object.keys(stats.byMonth).sort();
      const monthVals = months.map(m=>stats.byMonth[m]);
      window.dbMonthChart = new Chart(document.getElementById("db-bar-month"), {
        type: 'bar',
        data: {
          labels: months,
          datasets: [{
            label: "Monthly P&L",
            data: monthVals,
            backgroundColor: monthVals.map(v=>v>=0?chartColors.lightGreen:chartColors.red)
          }]
        },
        options: {
          plugins: { legend: {display:false} },
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: { ticks:{color:chartColors.gray}, grid:{color:'#28304a'} },
            y: { beginAtZero:true, ticks:{color:chartColors.gray}, grid:{color:'#28304a'} }
          }
        }
      });

      // --- Big Trades (Top 5 Wins & Losses) ---
      if(window.dbBigChart) window.dbBigChart.destroy();
      const bigLabels = [
        ...stats.bigWins.map(e=>`+${e.pnl.toFixed(2)} ${e.asset} [${e.date}]`),
        ...stats.bigLosses.map(e=>`${e.pnl.toFixed(2)} ${e.asset} [${e.date}]`)
      ];
      const bigData = [
        ...stats.bigWins.map(e=>e.pnl),
        ...stats.bigLosses.map(e=>e.pnl)
      ];
      window.dbBigChart = new Chart(document.getElementById("db-bar-bigtrades"), {
        type: 'bar',
        data: {
          labels: bigLabels,
          datasets: [{
            label: "Biggest Wins/Losses",
            data: bigData,
            backgroundColor: [
              ...stats.bigWins.map(e=>chartColors.lightGreen),
              ...stats.bigLosses.map(e=>chartColors.red)
            ]
          }]
        },
        options: {
          plugins: { legend: {display:false} },
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: { ticks:{color:chartColors.gray, autoSkip:false, maxRotation:60, minRotation:30}, grid:{color:'#28304a'} },
            y: { ticks:{color:chartColors.gray}, grid:{color:'#28304a'} }
          }
        }
      });

      // Top Mistakes/Lessons
      const mistakesList = document.getElementById("db-mistakes-list");
      mistakesList.innerHTML = "";
      if(stats.mistakes.length) {
        let freq = {};
        stats.mistakes.filter(Boolean).forEach(m=>{
          m.split(/[.;\n]/).map(x=>x.trim()).filter(x=>x).forEach(line=>{
            freq[line] = (freq[line]||0)+1;
          });
        });
        const top = Object.entries(freq)
          .sort((a,b)=>b[1]-a[1])
          .slice(0,7)
          .map(([txt,count])=>`<li><b>${count}√ó</b> ${txt}</li>`).join('');
        mistakesList.innerHTML = top || "<li>No mistakes/lessons recorded.</li>";
      } else {
        mistakesList.innerHTML = "<li>No mistakes/lessons recorded.</li>";
      }
    }

    function setupDashboardFilters() {
      document.getElementById("db-filter-reset").onclick = function() {
        document.getElementById("db-filter-asset").value = "";
        document.getElementById("db-filter-direction").value = "";
        document.getElementById("db-filter-datefrom").value = "";
        document.getElementById("db-filter-dateto").value = "";
        renderDashboard();
      };
      ["db-filter-asset","db-filter-direction","db-filter-datefrom","db-filter-dateto"].forEach(id => {
        document.getElementById(id).onchange = renderDashboard;
      });
    }

    document.addEventListener("DOMContentLoaded", ()=>{
      setupDashboardFilters();
      renderDashboard();
    });

    // Make renderDashboard available globally for journal sync
    window.renderDashboard = renderDashboard;
  </script>
</section>

<!-- CeFi/DeFi Onboarding Section -->
<section id="onboardingContent" class="hidden">
  <div class="manual-section p-8 rounded-xl shadow mb-8">
    
    <!-- Getting Started Overview Section -->
    <!-- Developer Note: Welcome section with embedded video for onboarding introduction -->
    <div class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl p-8 mb-8 text-center">
      <h2 class="text-4xl font-extrabold mb-6 text-white">üéØ Getting Started Overview</h2>
      <p class="text-2xl text-blue-100 mb-6 font-semibold">Welcome to Griffin Rise Trading Program</p>
      
      <!-- Video Embed Container -->
      <!-- Developer Note: Video iframe container with responsive design and fallback -->
      <div class="bg-gray-900/50 rounded-xl p-6 mb-6 max-w-4xl mx-auto">
        <div class="relative w-full responsive-video">
          <iframe 
            src="https://video.pictory.ai/202509102310031079656584aaef34ed9b7b4bd2a4185d759/20250910231947658HXxhnuPywlTWwpy"
            class="absolute top-0 left-0 w-full h-full rounded-lg"
            frameborder="0"
            allowfullscreen
            loading="lazy"
            title="Griffin Rise Trading Program Overview"
            aria-label="Introduction video for Griffin Rise Trading Program">
            <p>Your browser does not support iframes. Please visit <a href="https://video.pictory.ai/202509102310031079656584aaef34ed9b7b4bd2a4185d759/20250910231947658HXxhnuPywlTWwpy" target="_blank" rel="noopener">this link</a> to view the video.</p>
          </iframe>
        </div>
        <p class="text-gray-300 text-sm mt-4">
          üé• This video will guide you through the complete Griffin Rise Trading Program journey
        </p>
      </div>
      
      <!-- Overview Features -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 max-w-4xl mx-auto">
        <div class="bg-white/10 rounded-lg p-4">
          <div class="text-3xl mb-2">üöÄ</div>
          <h3 class="font-bold text-white mb-2">Quick Start</h3>
          <p class="text-blue-100 text-sm">Begin your trading journey with guided setup</p>
        </div>
        <div class="bg-white/10 rounded-lg p-4">
          <div class="text-3xl mb-2">üìö</div>
          <h3 class="font-bold text-white mb-2">Learn & Practice</h3>
          <p class="text-blue-100 text-sm">Master both CeFi and DeFi trading strategies</p>
        </div>
        <div class="bg-white/10 rounded-lg p-4">
          <div class="text-3xl mb-2">üèÜ</div>
          <h3 class="font-bold text-white mb-2">Achieve Success</h3>
          <p class="text-blue-100 text-sm">Earn badges and unlock advanced features</p>
        </div>
      </div>
    </div>

    <!-- Welcome Banner -->
    <div class="bg-gradient-to-r from-purple-600 to-blue-600 rounded-xl p-6 mb-8 text-center">
      <h2 class="text-4xl font-extrabold mb-4 text-white">üöÄ CeFi/DeFi Onboarding Tracks</h2>
      <p class="text-xl text-purple-100 mb-4">Master both Centralized and Decentralized Finance trading</p>
      <div class="bg-white/20 rounded-lg p-4 inline-block">
        <div class="flex items-center justify-center gap-4">
          <div class="text-center">
            <div class="text-2xl font-bold text-yellow-300">üíé</div>
            <div class="text-sm">CeFi Mastery</div>
          </div>
          <div class="text-2xl">+</div>
          <div class="text-center">
            <div class="text-2xl font-bold text-blue-300">üîó</div>
            <div class="text-sm">DeFi Skills</div>
          </div>
          <div class="text-2xl">=</div>
          <div class="text-center">
            <div class="text-2xl font-bold text-green-300">üèÜ</div>
            <div class="text-sm">Trading Pro</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Progress Tracker -->
    <div class="bg-gray-800 rounded-xl p-6 mb-8">
      <h3 class="text-2xl font-bold mb-4 text-blue-300 flex items-center gap-2">
        <span class="text-2xl">üìä</span> Your Onboarding Progress
      </h3>
      <div class="space-y-4">
        <div class="flex justify-between items-center mb-2">
          <span class="text-gray-300">Overall Progress</span>
          <span id="overall-progress-text" class="text-blue-300 font-semibold">0% Complete</span>
        </div>
        <div class="w-full bg-gray-700 rounded-full h-3">
          <div id="overall-progress-bar" class="bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
          <div class="bg-gray-700 rounded-lg p-4">
            <div class="flex items-center gap-2 mb-2">
              <span class="text-2xl">üè¶</span>
              <span class="font-semibold text-blue-300">CeFi Track</span>
            </div>
            <div class="w-full bg-gray-600 rounded-full h-2">
              <div id="cefi-progress-bar" class="bg-blue-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
            <span id="cefi-progress-text" class="text-sm text-gray-400">0/4 steps completed</span>
          </div>
          <div class="bg-gray-700 rounded-lg p-4">
            <div class="flex items-center gap-2 mb-2">
              <span class="text-2xl">üîó</span>
              <span class="font-semibold text-purple-300">DeFi Track</span>
            </div>
            <div class="w-full bg-gray-600 rounded-full h-2">
              <div id="defi-progress-bar" class="bg-purple-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
            <span id="defi-progress-text" class="text-sm text-gray-400">0/4 steps completed</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Onboarding Tracks -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      
      <!-- CeFi Track -->
      <div class="bg-blue-900/30 rounded-xl p-6 border border-blue-700">
        <div class="flex items-center gap-3 mb-6">
          <span class="text-3xl">üè¶</span>
          <div>
            <h3 class="text-2xl font-bold text-blue-300">CeFi Onboarding</h3>
            <p class="text-blue-200">Centralized Finance (MEXC Focus)</p>
          </div>
        </div>
        
        <!-- CeFi Steps -->
        <div class="space-y-4">
          <div class="cefi-step bg-gray-800 rounded-lg p-4 border-l-4 border-blue-500" data-step="1">
            <div class="flex items-center gap-3 mb-3">
              <div class="step-indicator w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center font-bold">1</div>
              <h4 class="text-lg font-semibold text-blue-300">MEXC Account Setup</h4>
              <span class="step-status ml-auto text-2xl">‚è≥</span>
            </div>
            <div class="step-content ml-11">
              <p class="text-gray-300 mb-3">Create and secure your MEXC exchange account</p>
              <button class="start-step-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition">Start Step</button>
              
              <!-- Developer Note: Step details with checklist for MEXC account setup -->
              <div class="step-details bg-gray-700 rounded-lg p-6 mt-4 hidden step-detail">
                <div class="text-center mb-4">
                  <div class="text-4xl mb-3">üè¶</div>
                  <h5 class="text-lg font-semibold mb-2">MEXC Account Setup Guide</h5>
                  <p class="text-gray-300 mb-4">Follow these steps to create your MEXC trading account</p>
                </div>
                <div class="p-4 bg-blue-900/50 rounded">
                  <h6 class="font-semibold mb-3 text-blue-200">‚úÖ Step-by-step checklist:</h6>
                  <div class="text-left space-y-2">
                    <label class="flex items-center gap-3 p-2 hover:bg-blue-800/30 rounded transition">
                      <input type="checkbox" class="step-checkbox w-4 h-4"> 
                      <span>Visit mexc.com and navigate to registration</span>
                    </label>
                    <label class="flex items-center gap-3 p-2 hover:bg-blue-800/30 rounded transition">
                      <input type="checkbox" class="step-checkbox w-4 h-4"> 
                      <span>Click "Sign Up" and choose email registration</span>
                    </label>
                    <label class="flex items-center gap-3 p-2 hover:bg-blue-800/30 rounded transition">
                      <input type="checkbox" class="step-checkbox w-4 h-4"> 
                      <span>Enter email and create a strong password</span>
                    </label>
                    <label class="flex items-center gap-3 p-2 hover:bg-blue-800/30 rounded transition">
                      <input type="checkbox" class="step-checkbox w-4 h-4"> 
                      <span>Verify your email address</span>
                    </label>
                    <label class="flex items-center gap-3 p-2 hover:bg-blue-800/30 rounded transition">
                      <input type="checkbox" class="step-checkbox w-4 h-4"> 
                      <span>Enable 2FA with Google Authenticator</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="cefi-step bg-gray-800 rounded-lg p-4 border-l-4 border-gray-500" data-step="2">
            <div class="flex items-center gap-3 mb-3">
              <div class="step-indicator w-8 h-8 rounded-full bg-gray-500 text-white flex items-center justify-center font-bold">2</div>
              <h4 class="text-lg font-semibold text-gray-400">Identity Verification</h4>
              <span class="step-status ml-auto text-2xl">üîí</span>
            </div>
            <div class="step-content ml-11">
              <p class="text-gray-400 mb-3">Complete KYC verification for full trading access</p>
              <div class="tooltip-hint text-sm text-yellow-300 bg-yellow-900/30 p-2 rounded mb-3">
                üí° Tip: Have your ID document ready for faster verification
              </div>
              <button class="start-step-btn bg-gray-600 text-white px-4 py-2 rounded transition cursor-not-allowed" disabled>Complete Step 1 First</button>
            </div>
          </div>

          <div class="cefi-step bg-gray-800 rounded-lg p-4 border-l-4 border-gray-500" data-step="3">
            <div class="flex items-center gap-3 mb-3">
              <div class="step-indicator w-8 h-8 rounded-full bg-gray-500 text-white flex items-center justify-center font-bold">3</div>
              <h4 class="text-lg font-semibold text-gray-400">Fund Your Account</h4>
              <span class="step-status ml-auto text-2xl">üîí</span>
            </div>
            <div class="step-content ml-11">
              <p class="text-gray-400 mb-3">Deposit funds for trading (start with $50-100)</p>
              <button class="start-step-btn bg-gray-600 text-white px-4 py-2 rounded transition cursor-not-allowed" disabled>Complete Previous Steps</button>
            </div>
          </div>

          <div class="cefi-step bg-gray-800 rounded-lg p-4 border-l-4 border-gray-500" data-step="4">
            <div class="flex items-center gap-3 mb-3">
              <div class="step-indicator w-8 h-8 rounded-full bg-gray-500 text-white flex items-center justify-center font-bold">4</div>
              <h4 class="text-lg font-semibold text-gray-400">First Trade</h4>
              <span class="step-status ml-auto text-2xl">üîí</span>
            </div>
            <div class="step-content ml-11">
              <p class="text-gray-400 mb-3">Execute your first trade using the Griffin's Rise strategy</p>
              <button class="start-step-btn bg-gray-600 text-white px-4 py-2 rounded transition cursor-not-allowed" disabled>Complete Previous Steps</button>
            </div>
          </div>
        </div>
      </div>

      <!-- DeFi Track -->
      <div class="bg-purple-900/30 rounded-xl p-6 border border-purple-700">
        <div class="flex items-center gap-3 mb-6">
          <span class="text-3xl">üîó</span>
          <div>
            <h3 class="text-2xl font-bold text-purple-300">DeFi Onboarding</h3>
            <p class="text-purple-200">Decentralized Finance Setup</p>
          </div>
        </div>
        
        <!-- DeFi Steps -->
        <div class="space-y-4">
          <div class="defi-step bg-gray-800 rounded-lg p-4 border-l-4 border-purple-500" data-step="1">
            <div class="flex items-center gap-3 mb-3">
              <div class="step-indicator w-8 h-8 rounded-full bg-purple-500 text-white flex items-center justify-center font-bold">1</div>
              <h4 class="text-lg font-semibold text-purple-300">Wallet Setup</h4>
              <span class="step-status ml-auto text-2xl">‚è≥</span>
            </div>
            <div class="step-content ml-11">
              <p class="text-gray-300 mb-3">Create and secure your MetaMask wallet</p>
              <button class="start-step-btn bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded transition">Start Step</button>
              
              <!-- Developer Note: Step details with checklist for MetaMask wallet setup -->
              <div class="step-details bg-gray-700 rounded-lg p-6 mt-4 hidden step-detail">
                <div class="text-center mb-4">
                  <div class="text-4xl mb-3">ü¶ä</div>
                  <h5 class="text-lg font-semibold mb-2">MetaMask Wallet Setup Guide</h5>
                  <p class="text-gray-300 mb-4">Secure wallet creation for DeFi trading</p>
                </div>
                <div class="p-4 bg-purple-900/50 rounded">
                  <h6 class="font-semibold mb-3 text-purple-200">‚úÖ Step-by-step checklist:</h6>
                  <div class="text-left space-y-2">
                    <label class="flex items-center gap-3 p-2 hover:bg-purple-800/30 rounded transition">
                      <input type="checkbox" class="step-checkbox w-4 h-4"> 
                      <span>Install MetaMask browser extension</span>
                    </label>
                    <label class="flex items-center gap-3 p-2 hover:bg-purple-800/30 rounded transition">
                      <input type="checkbox" class="step-checkbox w-4 h-4"> 
                      <span>Create new wallet and set strong password</span>
                    </label>
                    <label class="flex items-center gap-3 p-2 hover:bg-purple-800/30 rounded transition">
                      <input type="checkbox" class="step-checkbox w-4 h-4"> 
                      <span>Write down seed phrase securely (never share!)</span>
                    </label>
                    <label class="flex items-center gap-3 p-2 hover:bg-purple-800/30 rounded transition">
                      <input type="checkbox" class="step-checkbox w-4 h-4"> 
                      <span>Confirm seed phrase and complete setup</span>
                    </label>
                    <label class="flex items-center gap-3 p-2 hover:bg-purple-800/30 rounded transition">
                      <input type="checkbox" class="step-checkbox w-4 h-4"> 
                      <span>Understand wallet security basics</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="defi-step bg-gray-800 rounded-lg p-4 border-l-4 border-gray-500" data-step="2">
            <div class="flex items-center gap-3 mb-3">
              <div class="step-indicator w-8 h-8 rounded-full bg-gray-500 text-white flex items-center justify-center font-bold">2</div>
              <h4 class="text-lg font-semibold text-gray-400">Network Configuration</h4>
              <span class="step-status ml-auto text-2xl">üîí</span>
            </div>
            <div class="step-content ml-11">
              <p class="text-gray-400 mb-3">Add custom networks (Arbitrum, Polygon, etc.)</p>
              <button class="start-step-btn bg-gray-600 text-white px-4 py-2 rounded transition cursor-not-allowed" disabled>Complete Step 1 First</button>
            </div>
          </div>

          <div class="defi-step bg-gray-800 rounded-lg p-4 border-l-4 border-gray-500" data-step="3">
            <div class="flex items-center gap-3 mb-3">
              <div class="step-indicator w-8 h-8 rounded-full bg-gray-500 text-white flex items-center justify-center font-bold">3</div>
              <h4 class="text-lg font-semibold text-gray-400">DeFi Platform Access</h4>
              <span class="step-status ml-auto text-2xl">üîí</span>
            </div>
            <div class="step-content ml-11">
              <p class="text-gray-400 mb-3">Connect to Uniswap, PancakeSwap, and other DEXs</p>
              <button class="start-step-btn bg-gray-600 text-white px-4 py-2 rounded transition cursor-not-allowed" disabled>Complete Previous Steps</button>
            </div>
          </div>

          <div class="defi-step bg-gray-800 rounded-lg p-4 border-l-4 border-gray-500" data-step="4">
            <div class="flex items-center gap-3 mb-3">
              <div class="step-indicator w-8 h-8 rounded-full bg-gray-500 text-white flex items-center justify-center font-bold">4</div>
              <h4 class="text-lg font-semibold text-gray-400">First DeFi Trade</h4>
              <span class="step-status ml-auto text-2xl">üîí</span>
            </div>
            <div class="step-content ml-11">
              <p class="text-gray-400 mb-3">Execute your first decentralized trade</p>
              <button class="start-step-btn bg-gray-600 text-white px-4 py-2 rounded transition cursor-not-allowed" disabled>Complete Previous Steps</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Security Banner -->
    <div class="bg-red-900/30 border border-red-700 rounded-xl p-6 mt-8">
      <div class="flex items-center gap-3 mb-4">
        <span class="text-3xl">üîê</span>
        <h3 class="text-xl font-bold text-red-300">Security Reminder</h3>
      </div>
      <div class="space-y-2 text-red-200">
        <p>‚Ä¢ Never share your private keys or seed phrases</p>
        <p>‚Ä¢ Always verify website URLs before connecting wallets</p>
        <p>‚Ä¢ Start with small amounts when learning</p>
        <p>‚Ä¢ Enable 2FA on all accounts</p>
      </div>
    </div>

    <!-- Completion Celebration -->
    <!-- Developer Note: Achievement celebration with badge display and confetti animation -->
    <div id="completion-celebration" class="hidden bg-gradient-to-r from-green-600 to-blue-600 rounded-xl p-8 text-center mt-8">
      <div class="text-6xl mb-4">üéâ</div>
      <h3 class="text-3xl font-bold text-white mb-4">Congratulations!</h3>
      <p class="text-xl text-green-100 mb-6">You've completed your CeFi/DeFi onboarding journey!</p>
      
      <!-- Achievement Badge Display -->
      <div id="achievement-badge-display" class="hidden mb-6">
        <div class="bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full p-6 mx-auto w-32 h-32 flex items-center justify-center mb-4 shadow-2xl transform scale-0 transition-transform duration-500" id="achievement-badge">
          <div class="text-center">
            <div class="text-4xl mb-1">üèÜ</div>
            <div class="text-xs font-bold text-gray-900">TRADING</div>
            <div class="text-xs font-bold text-gray-900">MASTER</div>
          </div>
        </div>
        <div id="achievement-message" class="text-2xl font-bold text-yellow-300 mb-4 opacity-0 transition-opacity duration-500">
          Now the Journey begins with Griffin's Rise!
        </div>
      </div>
      
      <div class="flex justify-center gap-4 flex-wrap">
        <button id="view-achievement-btn" class="bg-white text-green-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition transform hover:scale-105">
          üèÜ View Achievement Badge
        </button>
        <button id="start-journey-btn" class="bg-green-700 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-800 transition transform hover:scale-105">
          üöÄ Start Your Journey
        </button>
      </div>
    </div>
  </div>
</section>
</main>
<footer class="bg-[#232946] text-blue-200 py-4 mt-6 text-center border-t border-blue-900 font-semibold text-base shadow">
  &copy; 2025 Griffin's Rise: Advanced Trading Journal Pro Edition | Powered by Copilot & TailwindCSS
</footer>
<script>
/* ========= LOGIN & NAVIGATION JS ========= */

// ---- Tab & Content Elements ----
const educationTab = document.getElementById("educationTab");
const syllabusTab = document.getElementById("syllabusTab");
const trainingManualTab = document.getElementById("trainingManualTab");
const journalTab = document.getElementById("journalTab");
const dashboardTab = document.getElementById("dashboardTab");
const onboardingTab = document.getElementById("onboardingTab");
const loginTab = document.getElementById("loginTab");
const logoutBtn = document.getElementById("logoutBtn");
const educationContent = document.getElementById("educationContent");
const syllabusContent = document.getElementById("syllabusContent");
const trainingManualContent = document.getElementById("trainingManualContent");
const journalContent = document.getElementById("journalContent");
const dashboardContent = document.getElementById("dashboardContent");
const onboardingContent = document.getElementById("onboardingContent");
const loginContent = document.getElementById("loginContent");
const loginForm = document.getElementById("loginForm");
const registerForm = document.getElementById("registerForm");
const switchToRegister = document.getElementById("switchToRegister");
const switchToLogin = document.getElementById("switchToLogin");
const loginMessage = document.getElementById("loginMessage");

// ---- Auth State ----
function setLoggedIn(loggedIn, username="") {
  localStorage.setItem("loggedIn", loggedIn ? "yes" : "no");
  if (loggedIn && username) {
    localStorage.setItem("username", username);
  } else {
    localStorage.removeItem("username");
  }
}
function isLoggedIn() {
  return localStorage.getItem("loggedIn") === "yes";
}

// ---- Nav/UI Update ----
function updateNavForLogin() {
  const navButtons = [onboardingTab, educationTab, syllabusTab, trainingManualTab, journalTab, dashboardTab];
  if (!isLoggedIn()) {
    navButtons.forEach(btn => btn && btn.classList.add("hidden"));
    if (loginTab) loginTab.classList.remove("hidden");
    if (logoutBtn) logoutBtn.classList.add("hidden");
    showTab("login");
  } else {
    navButtons.forEach(btn => btn && btn.classList.remove("hidden"));
    if (loginTab) loginTab.classList.add("hidden");
    if (logoutBtn) logoutBtn.classList.remove("hidden");
    showTab("onboarding");
  }
}
function showTab(tab) {
  [onboardingTab, educationTab, syllabusTab, trainingManualTab, journalTab, dashboardTab, loginTab].forEach(btn => btn && btn.classList.remove("tab-active"));
  educationContent && educationContent.classList.add("hidden");
  syllabusContent && syllabusContent.classList.add("hidden");
  trainingManualContent && trainingManualContent.classList.add("hidden");
  journalContent && journalContent.classList.add("hidden");
  dashboardContent && dashboardContent.classList.add("hidden");
  onboardingContent && onboardingContent.classList.add("hidden");
  loginContent && loginContent.classList.add("hidden");
  if (tab === "education") {educationContent && educationContent.classList.remove("hidden"); educationTab && educationTab.classList.add("tab-active");}
  if (tab === "syllabus") {syllabusContent && syllabusContent.classList.remove("hidden"); syllabusTab && syllabusTab.classList.add("tab-active");}
  if (tab === "trainingManual") {trainingManualContent && trainingManualContent.classList.remove("hidden"); trainingManualTab && trainingManualTab.classList.add("tab-active");}
  if (tab === "journal") {journalContent && journalContent.classList.remove("hidden"); journalTab && journalTab.classList.add("tab-active");}
  if (tab === "dashboard") {dashboardContent && dashboardContent.classList.remove("hidden"); dashboardTab && dashboardTab.classList.add("tab-active");}
  if (tab === "onboarding") {onboardingContent && onboardingContent.classList.remove("hidden"); onboardingTab && onboardingTab.classList.add("tab-active");}
  if (tab === "login") {loginContent && loginContent.classList.remove("hidden"); loginTab && loginTab.classList.add("tab-active");}
  window.scrollTo({top:0,behavior:'smooth'});
}

// ---- Nav Button Handlers ----
if (educationTab) educationTab.addEventListener("click", () => showTab("education"));
if (syllabusTab) syllabusTab.addEventListener("click", () => showTab("syllabus"));
if (trainingManualTab) trainingManualTab.addEventListener("click", () => showTab("trainingManual"));
if (journalTab) journalTab.addEventListener("click", () => showTab("journal"));
if (dashboardTab) dashboardTab.addEventListener("click", () => showTab("dashboard"));
if (onboardingTab) onboardingTab.addEventListener("click", () => showTab("onboarding"));
if (loginTab) loginTab.addEventListener("click", () => showTab("login"));
if (logoutBtn) logoutBtn.onclick = function() { setLoggedIn(false); updateNavForLogin(); };

// ---- Register/Login Toggle ----
if (switchToRegister) {
  switchToRegister.onclick = function() {
    loginForm && loginForm.classList.add("hidden");
    registerForm && registerForm.classList.remove("hidden");
    loginMessage && (loginMessage.textContent = "");
  };
}
if (switchToLogin) {
  switchToLogin.onclick = function() {
    registerForm && registerForm.classList.add("hidden");
    loginForm && loginForm.classList.remove("hidden");
    loginMessage && (loginMessage.textContent = "");
  };
}

// ---- Login Handler ----
if (loginForm) {
  loginForm.onsubmit = function(e) {
    e.preventDefault();
    const username = document.getElementById("login-username").value;
    setLoggedIn(true, username);
    updateNavForLogin();
    if (loginMessage) {
      loginMessage.textContent = "Logged in as " + username + "!";
      loginMessage.classList.remove("text-red-600");
      loginMessage.classList.add("text-green-400");
      setTimeout(() => { loginMessage.textContent = ""; }, 1200);
    }
  };
}

// ---- Register Handler ----
if (registerForm) {
  registerForm.onsubmit = function(e) {
    e.preventDefault();
    const user = document.getElementById("register-username").value;
    const pass = document.getElementById("register-password").value;
    const conf = document.getElementById("register-confirm").value;
    if (pass !== conf) {
      loginMessage.textContent = "Passwords do not match!";
      loginMessage.classList.remove("text-green-400");
      loginMessage.classList.add("text-red-600");
      return;
    }
    setLoggedIn(true, user);
    updateNavForLogin();
    loginMessage.textContent = "Registered as " + user + "!";
    loginMessage.classList.remove("text-red-600");
    loginMessage.classList.add("text-green-400");
    setTimeout(() => {
      loginMessage.textContent = "";
    }, 1200);
  };
}

// ---- On Page Load ----
updateNavForLogin();


</script>
<script>
// --- Auto-calculate PNL ---
function autoCalcJournalPNL() {
  const entry = parseFloat(document.getElementById("journal-entry").value || "0");
  const exit = parseFloat(document.getElementById("journal-exit").value || "0");
  const size = parseFloat(document.getElementById("journal-size").value || "0");
  const direction = document.getElementById("journal-direction").value;
  let pnl = 0;
  if (direction === "Long") pnl = (exit - entry) * size;
  else if (direction === "Short") pnl = (entry - exit) * size;
  document.getElementById("journal-pnl").value = pnl.toFixed(2);
}
["journal-entry", "journal-exit", "journal-size", "journal-direction"].forEach(id => {
  const el = document.getElementById(id);
  if (el) el.addEventListener("input", autoCalcJournalPNL);
});

// Clear All functionality
document.getElementById("journalClearBtn").onclick = function() {
  if (confirm("Are you sure you want to clear all journal entries? This cannot be undone.")) {
    const key = window.JOURNAL_KEY || "griffinsrise_journal_v1";
    localStorage.removeItem(key);
    localStorage.removeItem("syllabusCompletedPhases");
    // Clear the table body as well
    const tableBody = document.getElementById('journal-table-body');
    if (tableBody) tableBody.innerHTML = "";
    // Update all displays
    if (window.renderJournalTable) window.renderJournalTable();
    if (window.renderDashboard) window.renderDashboard();
    if (window.updateJournalStats) window.updateJournalStats();
    if (window.saveJournal) window.saveJournal();
    document.getElementById("journal-message").textContent = "All entries cleared!";
    setTimeout(() => {
      document.getElementById("journal-message").textContent = "";
    }, 3000);
  }
};

// Export CSV functionality
document.getElementById("journalExportBtn").onclick = function() {
  const key = window.JOURNAL_KEY || "griffinsrise_journal_v1";
  const data = JSON.parse(localStorage.getItem(key) || "[]");
  
  if (data.length === 0) {
    alert("No journal entries to export!");
    return;
  }
  
  // Create CSV content
  const headers = ["Date", "Asset", "Direction", "Phase", "Thesis", "Entry Price", "Exit Price", "Stop Loss", "Take Profit", "Position Size", "Outcome", "P&L ($)", "Emotion/Psychology", "Mistakes/Lessons"];
  const csvContent = [
    headers.join(","),
    ...data.map(entry => [
      entry.date || "",
      entry.asset || "",
      entry.direction || "",
      entry.phase || "",
      `"${(entry.thesis || "").replace(/"/g, '""')}"`,
      entry.entry || "",
      entry.exit || "",
      entry.sl || "",
      entry.tp || "",
      entry.size || "",
      entry.outcome || "",
      entry.pnl || "",
      `"${(entry.emotion || "").replace(/"/g, '""')}"`,
      `"${(entry.mistakes || "").replace(/"/g, '""')}"`
    ].join(","))
  ].join("\n");
  
  // Create and download file
  const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
  const link = document.createElement("a");
  const url = URL.createObjectURL(blob);
  link.setAttribute("href", url);
  link.setAttribute("download", `griffins_rise_journal_${new Date().toISOString().split('T')[0]}.csv`);
  link.style.visibility = "hidden";
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
  
  document.getElementById("journal-message").textContent = "Journal exported to CSV!";
  setTimeout(() => {
    document.getElementById("journal-message").textContent = "";
  }, 3000);
};
</script>

<script>
window.renderJournalTable = function() {
  // 1. Get the journal entries from localStorage
  const key = window.JOURNAL_KEY || "griffinsrise_journal_v1";
  const data = JSON.parse(localStorage.getItem(key) || "[]");

  // 2. Find your journal table body (add this <tbody id="journal-table-body"> if you don't have one)
  const tableBody = document.getElementById("journal-table-body");
  if (!tableBody) return;

  // 3. Clear table
  tableBody.innerHTML = "";

  // 4. Update progress stats
  if (window.updateJournalStats) {
    window.updateJournalStats();
  } else {
    document.getElementById("journal-progress").textContent = 
      data.length ? `${data.length} entries logged.` : "No entries yet.";
  }
  
  // 5. If no entries, stop here
  if (!data.length) {
    return;
  }

  // 6. Otherwise, show table rows
  for (let i = 0; i < data.length; i++) {
    const entry = data[i];
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${entry.date || ""}</td>
      <td>${entry.asset || ""}</td>
      <td>${entry.direction || ""}</td>
      <td>${entry.phase || ""}</td>
      <td>${entry.thesis || ""}</td>
      <td>${entry.entry || ""}</td>
      <td>${entry.exit || ""}</td>
      <td>${entry.sl || ""}</td>
      <td>${entry.tp || ""}</td>
      <td>${entry.size || ""}</td>
      <td>${entry.outcome || ""}</td>
      <td>${typeof entry.pnl !== "undefined" ? entry.pnl : ""}</td>
      <td>${entry.emotion || ""}</td>
      <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${entry.mistakes || ""}">${entry.mistakes || ""}</td>
      <td>
        <button onclick="editJournalEntry(${i})" class="bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded text-sm mr-1">
          <i class="fas fa-edit"></i>
        </button>
        <button onclick="deleteJournalEntry(${i})" class="bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-sm">
          <i class="fas fa-trash"></i>
        </button>
      </td>
    `;
    tableBody.appendChild(row);
  }
};

// Call on page load
document.addEventListener("DOMContentLoaded", window.renderJournalTable);

// Edit Journal Entry function
function editJournalEntry(index) {
  const key = window.JOURNAL_KEY || "griffinsrise_journal_v1";
  const data = JSON.parse(localStorage.getItem(key) || "[]");
  
  if (index >= 0 && index < data.length) {
    const entry = data[index];
    
    // Populate form with existing data
    document.getElementById("journal-date").value = entry.date || "";
    document.getElementById("journal-asset").value = entry.asset || "";
    document.getElementById("journal-direction").value = entry.direction || "";
    document.getElementById("journal-phase").value = entry.phase || "";
    document.getElementById("journal-thesis").value = entry.thesis || "";
    document.getElementById("journal-entry").value = entry.entry || "";
    document.getElementById("journal-exit").value = entry.exit || "";
    document.getElementById("journal-sl").value = entry.sl || "";
    document.getElementById("journal-tp").value = entry.tp || "";
    document.getElementById("journal-size").value = entry.size || "";
    document.getElementById("journal-outcome").value = entry.outcome || "";
    document.getElementById("journal-pnl").value = entry.pnl || "";
    document.getElementById("journal-emotion").value = entry.emotion || "";
    document.getElementById("journal-mistakes").value = entry.mistakes || "";
    
    // Store the index being edited
    window.editingIndex = index;
    
    // Change button text to indicate editing mode
    const submitBtn = document.querySelector("#journalForm button[type='submit']");
    submitBtn.textContent = "Update Entry";
    submitBtn.classList.add("bg-orange-600", "hover:bg-orange-700");
    submitBtn.classList.remove("bg-blue-700", "hover:bg-blue-800");
    
    // Scroll to form
    document.getElementById("journalForm").scrollIntoView({ behavior: "smooth" });
    
    document.getElementById("journal-message").textContent = "Editing entry...";
    setTimeout(() => {
      document.getElementById("journal-message").textContent = "";
    }, 2000);
  }
}

// Delete Journal Entry function
function deleteJournalEntry(index) {
  if (confirm("Are you sure you want to delete this journal entry? This cannot be undone.")) {
    const key = window.JOURNAL_KEY || "griffinsrise_journal_v1";
    const data = JSON.parse(localStorage.getItem(key) || "[]");
    
    if (index >= 0 && index < data.length) {
      data.splice(index, 1);
      localStorage.setItem(key, JSON.stringify(data));
      
      if (window.renderJournalTable) window.renderJournalTable();
      if (window.renderDashboard) window.renderDashboard();
      
      document.getElementById("journal-message").textContent = "Entry deleted!";
      setTimeout(() => {
        document.getElementById("journal-message").textContent = "";
      }, 3000);
    }
  }
}

// Update the form submission to handle both add and edit
document.addEventListener("DOMContentLoaded", function() {
  const journalForm = document.getElementById("journalForm");
  if (journalForm) {
    journalForm.onsubmit = function(e) {
  e.preventDefault();
  
  const entry = {
    date: document.getElementById("journal-date").value,
    asset: document.getElementById("journal-asset").value,
    direction: document.getElementById("journal-direction").value,
    phase: document.getElementById("journal-phase").value,
    thesis: document.getElementById("journal-thesis").value,
    entry: parseFloat(document.getElementById("journal-entry").value || "0"),
    exit: parseFloat(document.getElementById("journal-exit").value || "0"),
    sl: parseFloat(document.getElementById("journal-sl").value || "0"),
    tp: parseFloat(document.getElementById("journal-tp").value || "0"),
    size: parseFloat(document.getElementById("journal-size").value || "0"),
    outcome: document.getElementById("journal-outcome").value,
    pnl: parseFloat(document.getElementById("journal-pnl").value || "0"),
    emotion: document.getElementById("journal-emotion").value,
    mistakes: document.getElementById("journal-mistakes").value,
  };
  
  const key = window.JOURNAL_KEY || "griffinsrise_journal_v1";
  const data = JSON.parse(localStorage.getItem(key) || "[]");
  
  if (typeof window.editingIndex !== "undefined" && window.editingIndex >= 0) {
    // Update existing entry
    data[window.editingIndex] = entry;
    document.getElementById("journal-message").textContent = "Entry updated!";
    
    // Reset form to add mode
    const submitBtn = document.querySelector("#journalForm button[type='submit']");
    submitBtn.textContent = "Add Entry";
    submitBtn.classList.remove("bg-orange-600", "hover:bg-orange-700");
    submitBtn.classList.add("bg-blue-700", "hover:bg-blue-800");
    
    delete window.editingIndex;
  } else {
    // Add new entry
    data.push(entry);
    document.getElementById("journal-message").textContent = "Entry added!";
  }
  
  localStorage.setItem(key, JSON.stringify(data));
  this.reset();
  document.getElementById("journal-pnl").value = "";
  
  if (window.renderDashboard) {
    try {
      window.renderDashboard();
    } catch (error) {
      console.warn('Dashboard rendering failed:', error);
    }
  }
  if (window.renderJournalTable) window.renderJournalTable();
  
  setTimeout(() => {
    document.getElementById("journal-message").textContent = "";
  }, 3000);
    };
  }
});
</script>
<style>
/* --- Training Manual Color Overhaul for Dark Syllabus Look --- */
#trainingManualContent {
  background: #0f172a;
}
#trainingManualContent .bg-gradient-to-r,
#trainingManualContent .bg-gradient-to-br {
  background: linear-gradient(110deg, #1e293b 80%, #2563eb 100%) !important;
}
#trainingManualContent .rounded-xl,
#trainingManualContent .shadow-xl,
#trainingManualContent .shadow-lg {
  box-shadow: 0 2px 16px #0004 !important;
  border-radius: 1rem !important;
}
#trainingManualContent h2,
#trainingManualContent h3,
#trainingManualContent h4,
#trainingManualContent .text-white,
#trainingManualContent .font-extrabold {
  color: #fff !important;
}
#trainingManualContent h5,
#trainingManualContent .font-semibold {
  color: #2563eb !important;
}
#trainingManualContent .text-lg,
#trainingManualContent .text-blue-700,
#trainingManualContent .text-green-100,
#trainingManualContent .text-yellow-100,
#trainingManualContent .text-pink-100,
#trainingManualContent .text-purple-100 {
  color: #bae6fd !important;
}
#trainingManualContent .bg-white,
#trainingManualContent .bg-white.bg-opacity-95 {
  background: #1e293b !important;
  color: #fff !important;
}
#trainingManualContent .border-l-4 {
  border-left-width: 4px !important;
  border-color: #2563eb !important;
  background: #17255433 !important;
  border-radius: 0.5rem !important;
}
#trainingManualContent .text-blue-900,
#trainingManualContent .text-blue-800 {
  color: #60a5fa !important;
}
#trainingManualContent .italic,
#trainingManualContent .font-bold {
  color: #ffe066 !important;
}
#trainingManualContent .bg-blue-50,
#trainingManualContent .bg-purple-50,
#trainingManualContent .bg-green-50 {
  background: #172554 !important;
  color: #ffe066 !important;
}
#trainingManualContent .bg-white.bg-opacity-20 {
  background: #2563eb33 !important;
}
#trainingManualContent .text-red-600,
#trainingManualContent .text-red-500 {
  color: #f87171 !important;
}
#trainingManualContent a {
  color: #ffe066 !important;
  text-decoration: underline;
}
#trainingManualContent .bg-blue-900 {
  background: #172554 !important;
  color: #fff !important;
}
#trainingManualContent .text-yellow-300 {
  color: #ffe066 !important;
}
#trainingManualContent .bg-green-400,
#trainingManualContent .bg-blue-500,
#trainingManualContent .bg-yellow-400,
#trainingManualContent .bg-orange-500,
#trainingManualContent .bg-pink-400,
#trainingManualContent .bg-red-500,
#trainingManualContent .bg-purple-400,
#trainingManualContent .bg-green-400,
#trainingManualContent .bg-yellow-500 {
  background: linear-gradient(90deg, #1e293b 80%, #2563eb 100%) !important;
}
#trainingManualContent .bg-opacity-20 {
  background: #1e293b !important;
}
</style>
<script>
// Helper: Get all rows as data
// REMOVED: Old array-based journal functions - using object-based implementation instead

// Update stats/progress bar
window.updateJournalStats = function() {
  const key = window.JOURNAL_KEY || "griffinsrise_journal_v1";
  const data = JSON.parse(localStorage.getItem(key) || "[]");
  
  document.getElementById('journal-progress').textContent =
    data.length ? data.length + " entries logged." : "No entries yet.";
  
  // Progress bar/label  
  const bar = document.getElementById('journal-progress-bar');
  const label = document.getElementById('journal-progress-label');
  if(bar && label) {
    const pct = Math.min(100, Math.round(data.length / 10 * 100));
    bar.style.width = pct + "%";
    label.innerText = data.length + " entries ("+pct+"%)";
  }
};

// Load journal table on page load
if (window.renderJournalTable) {
  document.addEventListener("DOMContentLoaded", window.renderJournalTable);
}

</script>

<style>
/* Force proper width and wrapping for Thesis, Emotion, Mistakes, Actions columns */
/* Target the <tbody> so it affects dynamic rows as well */
#journal-table-body td.wrap-long {
  white-space: pre-wrap !important;
  word-break: break-word !important;
  overflow-wrap: break-word !important;
  min-width: 220px !important;   /* Ensures at least this width */
  max-width: 340px !important;   /* Prevents them from being too wide */
  width: 270px !important;
  writing-mode: horizontal-tb !important;
  vertical-align: top !important;
}
</style>
<script>
// --- P&L live preview in the form ---
function updatePnlPreview() {
  const entry = parseFloat(document.getElementById('journal-entry').value);
  const exit = parseFloat(document.getElementById('journal-exit').value);
  const size = parseFloat(document.getElementById('journal-size').value);
  const pnlBox = document.getElementById('journal-pnl');
  if (!isNaN(entry) && !isNaN(exit) && !isNaN(size)) {
    pnlBox.value = ((exit - entry) * size).toFixed(2);
  } else {
    pnlBox.value = '';
  }
}
['journal-entry','journal-exit','journal-size'].forEach(id => {
  const el = document.getElementById(id);
  if(el) el.addEventListener('input', updatePnlPreview);
});

// --- Table logic: consolidated for journal functionality ---
const WRAP_COLS = [4,12,13]; // Thesis, Emotion, Mistakes
const NUM_COLS = 15;

// PNL calculation helper
function calcPNL(entry, exit, size) {
  const e = parseFloat(entry), x = parseFloat(exit), s = parseFloat(size);
  return (!isNaN(e) && !isNaN(x) && !isNaN(s)) ? ((x - e) * s).toFixed(2) : "";
}

// REMOVED: Additional duplicate journal functions - using object-based implementation instead

document.addEventListener("DOMContentLoaded", function() {
  // Initialize journal table on load
  if (window.renderJournalTable) {
    window.renderJournalTable();
  }
  if (window.updatePnlPreview) {
    window.updatePnlPreview();
  }
});

// --- Style fixes: wrapping and P&L field color ---
const style = document.createElement("style");
style.textContent = `
#journal-table-body td.wrap-long {
  white-space: pre-wrap !important;
  word-break: break-word !important;
  overflow-wrap: break-word !important;
  min-width: 220px !important;
  max-width: 340px !important;
  width: 270px !important;
  vertical-align: top !important;
}
#journal-table-body td:focus {
  outline: 2px solid #60a5fa;
  background: #0d233d;
}
#journal-table-body button.edit-btn:hover {
  background: #1d4ed8;
}
#journal-table-body button.delete-btn:hover {
  background: #b91c1c;
}
    /* Match P&L input to table color */
#journal-pnl {
  background: #181e2a !important;
  color: #fff !important;
  opacity: 1 !important;
}

/* Confetti Animation for Achievement */
/* Developer Note: Confetti particles animation for achievement celebration */
@keyframes confetti-fall {
  0% {
    transform: translateY(-100vh) rotate(0deg);
    opacity: 1;
  }
  100% {
    transform: translateY(100vh) rotate(720deg);
    opacity: 0;
  }
}

.confetti-particle {
  position: fixed;
  width: 10px;
  height: 10px;
  pointer-events: none;
  z-index: 1000;
  animation: confetti-fall 3s linear infinite;
}

.confetti-particle:nth-child(odd) {
  background: #f59e0b;
  border-radius: 50%;
}

.confetti-particle:nth-child(even) {
  background: #10b981;
  transform: rotate(45deg);
}

.confetti-particle:nth-child(3n) {
  background: #3b82f6;
  border-radius: 50%;
}

.confetti-particle:nth-child(4n) {
  background: #ef4444;
  width: 6px;
  height: 6px;
}

.confetti-particle:nth-child(5n) {
  background: #8b5cf6;
  border-radius: 50%;
  width: 8px;
  height: 8px;
}

/* Achievement Badge Animation */
.achievement-badge-animate {
  animation: achievement-bounce 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes achievement-bounce {
  0% {
    transform: scale(0) rotate(-180deg);
    opacity: 0;
  }
  50% {
    transform: scale(1.2) rotate(-90deg);
    opacity: 0.8;
  }
  100% {
    transform: scale(1) rotate(0deg);
    opacity: 1;
  }
}

/* Pulse animation for Mark Complete buttons */
.pulse-complete {
  animation: pulse-glow 1.5s infinite;
}

@keyframes pulse-glow {
  0%, 100% {
    box-shadow: 0 0 5px rgba(34, 197, 94, 0.5);
  }
  50% {
    box-shadow: 0 0 20px rgba(34, 197, 94, 0.8), 0 0 30px rgba(34, 197, 94, 0.4);
  }
}
`;
document.head.appendChild(style);

/* ========= ONBOARDING FUNCTIONALITY ========= */
/* Developer Note: Enhanced onboarding with toggleable completion and achievement system */

// Onboarding progress tracking with persistent storage
let ceFiProgress = parseInt(localStorage.getItem('cefi_progress') || '0');
let deFiProgress = parseInt(localStorage.getItem('defi_progress') || '0');
const totalSteps = 4;

// Step completion state tracking
let completedSteps = JSON.parse(localStorage.getItem('completed_steps') || '{"cefi": [], "defi": []}');

function saveProgress() {
  localStorage.setItem('cefi_progress', ceFiProgress.toString());
  localStorage.setItem('defi_progress', deFiProgress.toString());
  localStorage.setItem('completed_steps', JSON.stringify(completedSteps));
}

function updateOnboardingProgress() {
  const overallProgress = Math.round(((ceFiProgress + deFiProgress) / (totalSteps * 2)) * 100);
  
  // Update progress bars
  const overallBar = document.getElementById('overall-progress-bar');
  const ceFiBar = document.getElementById('cefi-progress-bar');
  const deFiBar = document.getElementById('defi-progress-bar');
  
  if (overallBar) overallBar.style.width = overallProgress + '%';
  if (ceFiBar) ceFiBar.style.width = (ceFiProgress / totalSteps) * 100 + '%';
  if (deFiBar) deFiBar.style.width = (deFiProgress / totalSteps) * 100 + '%';
  
  // Update progress text
  const overallText = document.getElementById('overall-progress-text');
  const ceFiText = document.getElementById('cefi-progress-text');
  const deFiText = document.getElementById('defi-progress-text');
  
  if (overallText) overallText.textContent = overallProgress + '% Complete';
  if (ceFiText) ceFiText.textContent = ceFiProgress + '/' + totalSteps + ' steps completed';
  if (deFiText) deFiText.textContent = deFiProgress + '/' + totalSteps + ' steps completed';
  
  // Show/hide achievement buttons based on progress
  const viewAchievementBtn = document.getElementById('view-achievement-btn');
  const startJourneyBtn = document.getElementById('start-journey-btn');
  
  if (overallProgress === 100) {
    const celebration = document.getElementById('completion-celebration');
    if (celebration) {
      celebration.classList.remove('hidden');
      celebration.scrollIntoView({ behavior: 'smooth' });
    }
    // Show achievement buttons only when 100% complete
    if (viewAchievementBtn) viewAchievementBtn.style.display = 'inline-block';
    if (startJourneyBtn) startJourneyBtn.style.display = 'inline-block';
  } else {
    // Hide achievement buttons if not 100% complete
    if (viewAchievementBtn) viewAchievementBtn.style.display = 'none';
    if (startJourneyBtn) startJourneyBtn.style.display = 'none';
  }
}

// Toggle step completion (mark/unmark functionality)
function toggleStepCompletion(track, stepNumber) {
  const stepKey = `${track}-${stepNumber}`;
  const isCompleted = completedSteps[track].includes(stepNumber);
  
  if (isCompleted) {
    // Unmark as complete
    completedSteps[track] = completedSteps[track].filter(s => s !== stepNumber);
    if (track === 'cefi') {
      ceFiProgress = Math.max(0, completedSteps.cefi.length);
    } else {
      deFiProgress = Math.max(0, completedSteps.defi.length);
    }
  } else {
    // Mark as complete
    if (!completedSteps[track].includes(stepNumber)) {
      completedSteps[track].push(stepNumber);
    }
    if (track === 'cefi') {
      ceFiProgress = completedSteps.cefi.length;
    } else {
      deFiProgress = completedSteps.defi.length;
    }
  }
  
  updateStepUI(track, stepNumber, !isCompleted);
  saveProgress();
  updateOnboardingProgress();
}

function updateStepUI(track, stepNumber, isCompleted) {
  const selector = track === 'cefi' ? '.cefi-step' : '.defi-step';
  const steps = document.querySelectorAll(selector);
  const currentStep = steps[stepNumber - 1];
  
  if (currentStep) {
    const indicator = currentStep.querySelector('.step-indicator');
    const status = currentStep.querySelector('.step-status');
    const border = currentStep;
    const button = currentStep.querySelector('.start-step-btn');
    
    if (isCompleted) {
      // Mark as completed
      indicator.classList.remove('bg-blue-500', 'bg-purple-500', 'bg-gray-500');
      indicator.classList.add('bg-green-500');
      status.textContent = '‚úÖ';
      border.classList.remove('border-blue-500', 'border-purple-500', 'border-gray-500');
      border.classList.add('border-green-500');
      
      if (button) {
        button.textContent = '‚Ü©Ô∏è Unmark Complete';
        button.classList.remove('bg-blue-600', 'bg-purple-600', 'bg-gray-600');
        button.classList.add('bg-orange-600', 'hover:bg-orange-700');
        button.disabled = false;
      }
    } else {
      // Mark as incomplete
      const baseColor = track === 'cefi' ? 'blue' : 'purple';
      indicator.classList.remove('bg-green-500', 'bg-gray-500');
      indicator.classList.add(`bg-${baseColor}-500`);
      status.textContent = '‚è≥';
      border.classList.remove('border-green-500', 'border-gray-500');
      border.classList.add(`border-${baseColor}-500`);
      
      if (button) {
        button.textContent = 'Mark Complete';
        button.classList.remove('bg-orange-600', 'hover:bg-orange-700', 'bg-gray-600');
        button.classList.add(`bg-${baseColor}-600`, `hover:bg-${baseColor}-700`);
        button.disabled = false;
      }
    }
  }
}

// Confetti animation function
function createConfetti() {
  const colors = ['#f59e0b', '#10b981', '#3b82f6', '#ef4444', '#8b5cf6'];
  const confettiCount = 50;
  
  for (let i = 0; i < confettiCount; i++) {
    setTimeout(() => {
      const confetti = document.createElement('div');
      confetti.className = 'confetti-particle';
      confetti.style.left = Math.random() * 100 + 'vw';
      confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
      confetti.style.animationDelay = Math.random() * 3 + 's';
      confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
      
      document.body.appendChild(confetti);
      
      // Remove confetti after animation
      setTimeout(() => {
        confetti.remove();
      }, 5000);
    }, i * 50);
  }
}

// Initialize step UI based on saved progress
function initializeStepUI() {
  // Initialize CeFi steps
  for (let i = 1; i <= totalSteps; i++) {
    const isCompleted = completedSteps.cefi.includes(i);
    updateStepUI('cefi', i, isCompleted);
  }
  
  // Initialize DeFi steps
  for (let i = 1; i <= totalSteps; i++) {
    const isCompleted = completedSteps.defi.includes(i);
    updateStepUI('defi', i, isCompleted);
  }
}

// Add event listeners for step buttons
document.addEventListener('DOMContentLoaded', function() {
  // Initialize UI
  initializeStepUI();
  updateOnboardingProgress();
  
  // CeFi step buttons
  document.querySelectorAll('.cefi-step .start-step-btn').forEach((btn, index) => {
    btn.addEventListener('click', function() {
      const step = this.closest('.cefi-step');
      const stepDetail = step.querySelector('.step-detail');
      
      if (stepDetail) {
        stepDetail.classList.toggle('hidden');
      }
      
      // Toggle completion
      if (this.textContent.includes('Mark Complete') || this.textContent.includes('Unmark Complete')) {
        toggleStepCompletion('cefi', index + 1);
      }
    });
  });
  
  // DeFi step buttons
  document.querySelectorAll('.defi-step .start-step-btn').forEach((btn, index) => {
    btn.addEventListener('click', function() {
      const step = this.closest('.defi-step');
      const stepDetail = step.querySelector('.step-detail');
      
      if (stepDetail) {
        stepDetail.classList.toggle('hidden');
      }
      
      // Toggle completion
      if (this.textContent.includes('Mark Complete') || this.textContent.includes('Unmark Complete')) {
        toggleStepCompletion('defi', index + 1);
      }
    });
  });
  
  // Achievement badge button
  const viewAchievementBtn = document.getElementById('view-achievement-btn');
  if (viewAchievementBtn) {
    viewAchievementBtn.addEventListener('click', function() {
      const badgeDisplay = document.getElementById('achievement-badge-display');
      const badge = document.getElementById('achievement-badge');
      const message = document.getElementById('achievement-message');
      
      if (badgeDisplay && badge && message) {
        badgeDisplay.classList.remove('hidden');
        
        // Animate badge appearance
        setTimeout(() => {
          badge.classList.add('achievement-badge-animate');
          badge.style.transform = 'scale(1)';
        }, 100);
        
        // Show message with delay
        setTimeout(() => {
          message.style.opacity = '1';
        }, 800);
        
        // Create confetti
        createConfetti();
        
        // Scroll to badge
        badgeDisplay.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    });
  }
  
  // Start Your Journey button
  const startJourneyBtn = document.getElementById('start-journey-btn');
  if (startJourneyBtn) {
    startJourneyBtn.addEventListener('click', function() {
      // Navigate to Education tab
      showTab('education');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  }
  
  // Step checkbox functionality
  document.querySelectorAll('.step-checkbox').forEach(checkbox => {
    checkbox.addEventListener('change', function() {
      const checkedBoxes = this.closest('.step-detail').querySelectorAll('.step-checkbox:checked');
      const totalBoxes = this.closest('.step-detail').querySelectorAll('.step-checkbox');
      const completeBtn = this.closest('.cefi-step, .defi-step').querySelector('.start-step-btn');
      
      if (checkedBoxes.length === totalBoxes.length && completeBtn && completeBtn.textContent.includes('Mark Complete')) {
        completeBtn.classList.add('pulse-complete');
        setTimeout(() => completeBtn.classList.remove('pulse-complete'), 3000);
      }
    });
  });
});

</script>
</body>
</html>
